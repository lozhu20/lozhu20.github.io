<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="baidu-site-verification" content="" />
    <meta name="msvalidate.01" content="" />
    <style>
      body { visibility: hidden; }
    </style>
    <meta name="description" content="åŸºç¡€çŸ¥è¯†ä¸ºä»€ä¹ˆéœ€è¦ HiveHadoop ç”Ÿæ€ç³»ç»Ÿçš„å‡ºç°ï¼Œä¸ºä»¥åˆç†çš„æˆæœ¬å¤„ç†å¤§æ•°æ®é›†æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå®ƒåŸºäº HDFSï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰å®ç°äº†ä¸€ä¸ª MapReduce ç¼–ç¨‹æ¨¡å‹ï¼Œå°†è®¡ç®—ä»»åŠ¡åˆ†æ•£åˆ°å¤šä¸ªç¡¬ä»¶æœºå™¨ä¸Šï¼Œä»è€Œé™ä½æˆæœ¬å¹¶æä¾›æ°´å¹³ä¼¸ç¼©æ€§ã€‚ ä½†æ˜¯ä»ç°æœ‰çš„æ•°æ®åŸºç¡€æ¶æ„è½¬ç§»åˆ° Hadoop ä»¥åŠä» Hadoop ä¸­è·å–æ•°æ®æ˜¯ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼ˆMapReduce Java APIï¼‰ï¼ŒHive çš„å‡ºç°">
<meta property="og:type" content="article">
<meta property="og:title" content="Hiveå­¦ä¹ ç¬”è®°">
<meta property="og:url" content="https://zhu.happy365.day/20220320/learn-about-hive/index.html">
<meta property="og:site_name" content="ç§‹è‘µç¬”è®° | qiukui-note">
<meta property="og:description" content="åŸºç¡€çŸ¥è¯†ä¸ºä»€ä¹ˆéœ€è¦ HiveHadoop ç”Ÿæ€ç³»ç»Ÿçš„å‡ºç°ï¼Œä¸ºä»¥åˆç†çš„æˆæœ¬å¤„ç†å¤§æ•°æ®é›†æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå®ƒåŸºäº HDFSï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰å®ç°äº†ä¸€ä¸ª MapReduce ç¼–ç¨‹æ¨¡å‹ï¼Œå°†è®¡ç®—ä»»åŠ¡åˆ†æ•£åˆ°å¤šä¸ªç¡¬ä»¶æœºå™¨ä¸Šï¼Œä»è€Œé™ä½æˆæœ¬å¹¶æä¾›æ°´å¹³ä¼¸ç¼©æ€§ã€‚ ä½†æ˜¯ä»ç°æœ‰çš„æ•°æ®åŸºç¡€æ¶æ„è½¬ç§»åˆ° Hadoop ä»¥åŠä» Hadoop ä¸­è·å–æ•°æ®æ˜¯ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼ˆMapReduce Java APIï¼‰ï¼ŒHive çš„å‡ºç°">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-749cc641eb4d5dafd085e8c23f8826aa_1440w.jpg?source=1940ef5c">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-48240f0e1e0dd33ec89100cbe2d30707_1440w.jpg?source=1940ef5c">
<meta property="article:published_time" content="2022-03-20T06:35:54.000Z">
<meta property="article:modified_time" content="2025-11-29T16:20:32.217Z">
<meta property="article:author" content="ç§‹è‘µç¬”è®°">
<meta property="article:tag" content="å¤§æ•°æ®">
<meta property="article:tag" content="Hive">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic1.zhimg.com/80/v2-749cc641eb4d5dafd085e8c23f8826aa_1440w.jpg?source=1940ef5c">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Hiveå­¦ä¹ ç¬”è®°</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
  
    
      <link rel="canonical" href="https://zhu.happy365.day/20220320/learn-about-hive/" />
    
  
  <script src="/js/switch-theme.js"></script> 
  <script src="/js/random-sentence.js"></script>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ç§‹è‘µç¬”è®° | qiukui-note" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="modal" class="modal">
  <span id="modal_close_btn" class="modal-close-btn">x</span>
  <img id="modal_image" class="modal-image">
  <!-- <div id="caption"></div> -->
</div>

      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="é¡¶éƒ¨" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        
          
            <a href="/">é¦–é¡µ</a>
          
        
          
            <a href="/archives/">å½’æ¡£</a>
          
        
          
            <a href="/friends/">å‹é“¾</a>
          
        
          
            <a target="_blank" rel="noopener" href="https://domain-forsale.happy365.day">åŸŸåå‡ºå”®</a>
          
        
          
            <a href="/about/">å…³äº</a>
          
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="ä¸Šä¸€ç¯‡" href="/20220401/spark-task-timeout/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="ä¸‹ä¸€ç¯‡" href="/20220319/settings-in-hadoop-and-hive/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="è¿”å›é¡¶éƒ¨" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="åˆ†äº«æ–‡ç« " href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zhu.happy365.day/20220320/learn-about-hive/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li> -->
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zhu.happy365.day/20220320/learn-about-hive/&text=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zhu.happy365.day/20220320/learn-about-hive/&is_video=false&description=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li> -->
  <li><a class="icon" href="mailto:?subject=Hiveå­¦ä¹ ç¬”è®°&body=Check out this article: https://zhu.happy365.day/20220320/learn-about-hive/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-reddit " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-digg " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zhu.happy365.day/20220320/learn-about-hive/&name=Hiveå­¦ä¹ ç¬”è®°&description=&lt;h2 id=&#34;åŸºç¡€çŸ¥è¯†&#34;&gt;&lt;a href=&#34;#åŸºç¡€çŸ¥è¯†&#34; class=&#34;headerlink&#34; title=&#34;åŸºç¡€çŸ¥è¯†&#34;&gt;&lt;/a&gt;åŸºç¡€çŸ¥è¯†&lt;/h2&gt;&lt;h3 id=&#34;ä¸ºä»€ä¹ˆéœ€è¦-Hive&#34;&gt;&lt;a href=&#34;#ä¸ºä»€ä¹ˆéœ€è¦-Hive&#34; class=&#34;headerlink&#34; title=&#34;ä¸ºä»€ä¹ˆéœ€è¦ Hive&#34;&gt;&lt;/a&gt;ä¸ºä»€ä¹ˆéœ€è¦ Hive&lt;/h3&gt;&lt;p&gt;Hadoop ç”Ÿæ€ç³»ç»Ÿçš„å‡ºç°ï¼Œä¸ºä»¥åˆç†çš„æˆæœ¬å¤„ç†å¤§æ•°æ®é›†æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå®ƒåŸºäº HDFSï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰å®ç°äº†ä¸€ä¸ª MapReduce ç¼–ç¨‹æ¨¡å‹ï¼Œå°†è®¡ç®—ä»»åŠ¡åˆ†æ•£åˆ°å¤šä¸ªç¡¬ä»¶æœºå™¨ä¸Šï¼Œä»è€Œé™ä½æˆæœ¬å¹¶æä¾›æ°´å¹³ä¼¸ç¼©æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä»ç°æœ‰çš„æ•°æ®åŸºç¡€æ¶æ„è½¬ç§»åˆ° Hadoop ä»¥åŠä» Hadoop ä¸­è·å–æ•°æ®æ˜¯ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼ˆMapReduce Java APIï¼‰ï¼ŒHive çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŸºäº Hive å¯ä»¥æ–¹ä¾¿çš„å®ç°ç»“æ„åŒ–æ•°æ®åˆ° Hadoop æ•°æ®ä»“åº“çš„æ•°æ®è½¬ç§»ã€‚&lt;/p&gt;
&lt;p&gt;Hive å°†å¤§å¤šæ•°çš„æŸ¥è¯¢è½¬åŒ–æˆ MR ä»»åŠ¡ï¼ŒHiveQL æ—¢é™ä½äº†ä½¿ç”¨éš¾åº¦ï¼Œä¹Ÿæé«˜äº† Hadoop çš„æ‰©å±•æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;Hive-çš„å±€é™&#34;&gt;&lt;a href=&#34;#Hive-çš„å±€é™&#34; class=&#34;headerlink&#34; title=&#34;Hive çš„å±€é™&#34;&gt;&lt;/a&gt;Hive çš„å±€é™&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Hive é€‚ç”¨äºæ•°æ®ä¸ç»å¸¸å˜åŠ¨ï¼Œè€Œä¸”ä¸éœ€è¦ç«‹å³å¾—åˆ°æŸ¥è¯¢ç»“æœçš„æƒ…å†µã€‚&lt;/li&gt;
&lt;li&gt;ç”±äº Hadoop å’Œ HDFS çš„è®¾è®¡ï¼ŒHive ä¸æ”¯æŒè¡Œçº§åˆ«çš„æ’å…¥ã€åˆ é™¤åŠæ›´æ–°ï¼Œä¸æ”¯æŒäº‹åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;HiveQL ä¸ç¬¦åˆ ANSI SQL æ ‡å‡†ï¼Œå¾ˆå¤š SQL å’Œ Oracleã€MySQL å­˜åœ¨å·®å¼‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;Java-å’Œ-Hive-ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•&#34;&gt;&lt;a href=&#34;#Java-å’Œ-Hive-ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•&#34; class=&#34;headerlink&#34; title=&#34;Java å’Œ Hive ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•&#34;&gt;&lt;/a&gt;Java å’Œ Hive ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•&lt;/h3&gt;&lt;p&gt;è¿™æ˜¯ã€ŠHadoopæƒå¨æŒ‡å—ã€‹ä¸­çš„ç¬¬ä¸€ç« çš„ä¾‹å­ç¨‹åºï¼Œä½¿ç”¨ Hadoop Java API å®ç°ä¸€ä¸ªç»Ÿè®¡æ–‡æœ¬æ–‡ä»¶ä¸­æ¯ä¸ªå•è¯å‡ºç°æ¬¡æ•°çš„ç¨‹åºï¼Œå¯ä»¥å¸®åŠ©ç†è§£ MR åŸç†ä»¥åŠä½¿ç”¨ Hive çš„å¥½å¤„ã€‚&lt;/p&gt;
&lt;p&gt;å…³é”®ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zhu.happy365.day/20220320/learn-about-hive/&t=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li> -->
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">åŸºç¡€çŸ¥è¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-Hive"><span class="toc-number">1.1.</span> <span class="toc-text">ä¸ºä»€ä¹ˆéœ€è¦ Hive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E7%9A%84%E5%B1%80%E9%99%90"><span class="toc-number">1.2.</span> <span class="toc-text">Hive çš„å±€é™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-%E5%92%8C-Hive-%EF%BC%9A%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1%E7%AE%97%E6%B3%95"><span class="toc-number">1.3.</span> <span class="toc-text">Java å’Œ Hive ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.</span> <span class="toc-text">Hive å‘½ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CLI-%E9%80%89%E9%A1%B9"><span class="toc-number">2.1.</span> <span class="toc-text">CLI é€‰é¡¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E7%9A%84%E5%B1%9E%E6%80%A7%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-number">2.2.</span> <span class="toc-text">Hive çš„å±æ€§å‘½åç©ºé—´</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E4%B8%AD%E4%BD%BF%E7%94%A8%E4%B8%80%E6%AC%A1%E5%91%BD%E4%BB%A4"><span class="toc-number">2.3.</span> <span class="toc-text">Hive ä¸­ä½¿ç”¨ä¸€æ¬¡å‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E6%96%87%E4%BB%B6%E4%B8%AD%E6%89%A7%E8%A1%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.4.</span> <span class="toc-text">ä»æ–‡ä»¶ä¸­æ‰§è¡ŒæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hiverc%E6%96%87%E4%BB%B6"><span class="toc-number">2.5.</span> <span class="toc-text">hivercæ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C-shell-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.6.</span> <span class="toc-text">æ‰§è¡Œ shell å‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8-Hive-%E5%86%85%E4%BD%BF%E7%94%A8-dfs-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.7.</span> <span class="toc-text">åœ¨ Hive å†…ä½¿ç”¨ dfs å‘½ä»¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">æ•°æ®ç±»å‹å’Œæ–‡ä»¶æ ¼å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#byte%E3%80%81Byte%E3%80%81bit%E3%80%81%E5%AD%97%E8%8A%82"><span class="toc-number">3.1.</span> <span class="toc-text">byteã€Byteã€bitã€å­—èŠ‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.2.</span> <span class="toc-text">Hive ä¸­çš„æ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.</span> <span class="toc-text">é›†åˆç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89"><span class="toc-number">4.</span> <span class="toc-text">HiveQL æ•°æ®å®šä¹‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%A7%88"><span class="toc-number">4.1.</span> <span class="toc-text">æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.2.</span> <span class="toc-text">å¸¸è§æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E9%83%A8%E8%A1%A8%E4%B8%8E%E5%A4%96%E9%83%A8%E8%A1%A8%EF%BC%88MANAGED-TABLE-EXTERNAL-TABLE%EF%BC%89"><span class="toc-number">4.3.</span> <span class="toc-text">å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨ï¼ˆMANAGED_TABLE &amp; EXTERNAL_TABLEï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8%E5%92%8C%E7%AE%A1%E7%90%86%E8%A1%A8"><span class="toc-number">5.</span> <span class="toc-text">åˆ†åŒºè¡¨å’Œç®¡ç†è¡¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%A1%A8%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">å¯¹è¡¨çš„æ“ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">7.</span> <span class="toc-text">HiveQL æ•°æ®æ“ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.</span> <span class="toc-text">HiveQL æŸ¥è¯¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%EF%BC%9A"><span class="toc-number">8.1.</span> <span class="toc-text">å¸¸ç”¨å‡½æ•°ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97-SELECT"><span class="toc-number">8.2.</span> <span class="toc-text">åµŒå¥— SELECT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CASE-WHEN"><span class="toc-number">8.3.</span> <span class="toc-text">CASE WHEN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%BF%E5%85%8D%E8%BF%9B%E8%A1%8C-MapReduce"><span class="toc-number">8.4.</span> <span class="toc-text">é¿å…è¿›è¡Œ MapReduce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2-cast"><span class="toc-number">8.5.</span> <span class="toc-text">ç±»å‹è½¬æ¢ cast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E6%A0%B7%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.6.</span> <span class="toc-text">æŠ½æ ·æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UNION-ALL"><span class="toc-number">8.7.</span> <span class="toc-text">UNION ALL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E8%A7%86%E5%9B%BE"><span class="toc-number">9.</span> <span class="toc-text">HiveQL è§†å›¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E7%B4%A2%E5%BC%95"><span class="toc-number">10.</span> <span class="toc-text">HiveQL ç´¢å¼•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1"><span class="toc-number">11.</span> <span class="toc-text">æ¨¡å¼è®¾è®¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="toc-number">11.1.</span> <span class="toc-text">åˆ†åŒºè¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%AF%E4%B8%80%E9%94%AE%E5%92%8C%E6%A0%87%E5%87%86%E5%8C%96"><span class="toc-number">11.2.</span> <span class="toc-text">å”¯ä¸€é”®å’Œæ ‡å‡†åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E4%B8%80%E4%BB%BD%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%A4%9A%E6%AC%A1"><span class="toc-number">11.3.</span> <span class="toc-text">åŒä¸€ä»½æ•°æ®å¤„ç†å¤šæ¬¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E%E6%AF%8F%E4%B8%AA%E8%A1%A8%E7%9A%84%E5%88%86%E5%8C%BA"><span class="toc-number">11.4.</span> <span class="toc-text">å¯¹äºæ¯ä¸ªè¡¨çš„åˆ†åŒº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%A1%B6-%F0%9F%AA%A3"><span class="toc-number">11.5.</span> <span class="toc-text">åˆ†æ¡¶ ğŸª£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E8%A1%A8%E6%96%B0%E5%A2%9E%E5%88%97"><span class="toc-number">11.6.</span> <span class="toc-text">ä¸ºè¡¨æ–°å¢åˆ—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%88%97%E5%AD%98%E5%82%A8%E8%A1%A8-%F0%9F%93%A6"><span class="toc-number">11.7.</span> <span class="toc-text">ä½¿ç”¨åˆ—å­˜å‚¨è¡¨ ğŸ“¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8E%8B%E7%BC%A9-%F0%9F%97%9C%EF%B8%8F"><span class="toc-number">11.8.</span> <span class="toc-text">ä½¿ç”¨å‹ç¼© ğŸ—œï¸</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E8%AE%B0%E5%BD%95-%F0%9F%93%9D"><span class="toc-number">12.</span> <span class="toc-text">Hive å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè®°å½• ğŸ“</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Hiveå­¦ä¹ ç¬”è®°
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ç§‹è‘µç¬”è®°</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-03-20T06:35:54.000Z" class="dt-published" itemprop="datePublished">2022-03-20</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">å­¦ä¹ ç¬”è®°</a>
    </div>


      
    <!-- <div class="article-tag"> -->
    <div class="article-category">
        <i class="fa-solid fa-tag"></i>
        <!-- <a class="p-category" href="/tags/Hive/" rel="tag">Hive</a>, <a class="p-category" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">å¤§æ•°æ®</a> -->
        <a class="category-link" href="/tags/Hive/" rel="tag">Hive</a>, <a class="category-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">å¤§æ•°æ®</a>
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-clock"></i>
        
            <span class="word-count">3.5k words</span>
        
        
            <span class="meta-divider">, </span>
        
        
            <span class="time-to-read">13  mins.</span>
        
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id="ä¸ºä»€ä¹ˆéœ€è¦-Hive"><a href="#ä¸ºä»€ä¹ˆéœ€è¦-Hive" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ Hive"></a>ä¸ºä»€ä¹ˆéœ€è¦ Hive</h3><p>Hadoop ç”Ÿæ€ç³»ç»Ÿçš„å‡ºç°ï¼Œä¸ºä»¥åˆç†çš„æˆæœ¬å¤„ç†å¤§æ•°æ®é›†æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå®ƒåŸºäº HDFSï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰å®ç°äº†ä¸€ä¸ª MapReduce ç¼–ç¨‹æ¨¡å‹ï¼Œå°†è®¡ç®—ä»»åŠ¡åˆ†æ•£åˆ°å¤šä¸ªç¡¬ä»¶æœºå™¨ä¸Šï¼Œä»è€Œé™ä½æˆæœ¬å¹¶æä¾›æ°´å¹³ä¼¸ç¼©æ€§ã€‚</p>
<p>ä½†æ˜¯ä»ç°æœ‰çš„æ•°æ®åŸºç¡€æ¶æ„è½¬ç§»åˆ° Hadoop ä»¥åŠä» Hadoop ä¸­è·å–æ•°æ®æ˜¯ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼ˆMapReduce Java APIï¼‰ï¼ŒHive çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŸºäº Hive å¯ä»¥æ–¹ä¾¿çš„å®ç°ç»“æ„åŒ–æ•°æ®åˆ° Hadoop æ•°æ®ä»“åº“çš„æ•°æ®è½¬ç§»ã€‚</p>
<p>Hive å°†å¤§å¤šæ•°çš„æŸ¥è¯¢è½¬åŒ–æˆ MR ä»»åŠ¡ï¼ŒHiveQL æ—¢é™ä½äº†ä½¿ç”¨éš¾åº¦ï¼Œä¹Ÿæé«˜äº† Hadoop çš„æ‰©å±•æ€§ã€‚</p>
<h3 id="Hive-çš„å±€é™"><a href="#Hive-çš„å±€é™" class="headerlink" title="Hive çš„å±€é™"></a>Hive çš„å±€é™</h3><ul>
<li>Hive é€‚ç”¨äºæ•°æ®ä¸ç»å¸¸å˜åŠ¨ï¼Œè€Œä¸”ä¸éœ€è¦ç«‹å³å¾—åˆ°æŸ¥è¯¢ç»“æœçš„æƒ…å†µã€‚</li>
<li>ç”±äº Hadoop å’Œ HDFS çš„è®¾è®¡ï¼ŒHive ä¸æ”¯æŒè¡Œçº§åˆ«çš„æ’å…¥ã€åˆ é™¤åŠæ›´æ–°ï¼Œä¸æ”¯æŒäº‹åŠ¡ã€‚</li>
<li>HiveQL ä¸ç¬¦åˆ ANSI SQL æ ‡å‡†ï¼Œå¾ˆå¤š SQL å’Œ Oracleã€MySQL å­˜åœ¨å·®å¼‚ã€‚</li>
</ul>
<h3 id="Java-å’Œ-Hive-ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•"><a href="#Java-å’Œ-Hive-ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•" class="headerlink" title="Java å’Œ Hive ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•"></a>Java å’Œ Hive ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•</h3><p>è¿™æ˜¯ã€ŠHadoopæƒå¨æŒ‡å—ã€‹ä¸­çš„ç¬¬ä¸€ç« çš„ä¾‹å­ç¨‹åºï¼Œä½¿ç”¨ Hadoop Java API å®ç°ä¸€ä¸ªç»Ÿè®¡æ–‡æœ¬æ–‡ä»¶ä¸­æ¯ä¸ªå•è¯å‡ºç°æ¬¡æ•°çš„ç¨‹åºï¼Œå¯ä»¥å¸®åŠ©ç†è§£ MR åŸç†ä»¥åŠä½¿ç”¨ Hive çš„å¥½å¤„ã€‚</p>
<p>å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-hdfs<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-mapreduce-client-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> im.yuki.wordcount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> longkun</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/3/17 11:36 PM</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> hadoop è¯é¢‘ç»Ÿè®¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCount</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">OUTPUT_PATH</span> <span class="operator">=</span> <span class="string">&quot;hdfs://127.0.0.1:9000/hdp/0317/wordcountoutput/&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Map</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, LongWritable&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">LongWritable</span> <span class="variable">one</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LongWritable</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">            String[] words = value.toString().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            Text word;</span><br><span class="line">            <span class="keyword">for</span> (String w : words) &#123;</span><br><span class="line">                word = <span class="keyword">new</span> <span class="title class_">Text</span>(w);</span><br><span class="line">                context.write(word, one);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Reduce</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, LongWritable, Text, LongWritable&gt; &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;LongWritable&gt; values, Context context)</span> <span class="keyword">throws</span> IOException,</span><br><span class="line">                InterruptedException &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (LongWritable value : values) &#123;</span><br><span class="line">                count += value.get();</span><br><span class="line">            &#125;</span><br><span class="line">            context.write(key, <span class="keyword">new</span> <span class="title class_">LongWritable</span>(count));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®ç¯å¢ƒå˜é‡ HADOOP_USER_NAME</span></span><br><span class="line">        System.setProperty(<span class="string">&quot;HADOOP_USER_NAME&quot;</span>, <span class="string">&quot;longkun&quot;</span>);</span><br><span class="line">        <span class="comment">// è¯»å–é…ç½®æ–‡ä»¶</span></span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        configuration.set(<span class="string">&quot;fs.defaultFS&quot;</span>, <span class="string">&quot;hdfs://127.0.0.1:9000&quot;</span>);</span><br><span class="line">        configuration.set(<span class="string">&quot;yarn.resourcemanager.hostname&quot;</span>, <span class="string">&quot;hdp01&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">FileSystem</span> <span class="variable">fileSystem</span> <span class="operator">=</span> FileSystem.get(configuration);</span><br><span class="line"></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(configuration, <span class="string">&quot;WordCount&quot;</span>);</span><br><span class="line">        job.setJarByClass(WordCount.class);</span><br><span class="line">        job.setMapperClass(Map.class);</span><br><span class="line">        job.setCombinerClass(Reduce.class);</span><br><span class="line">        job.setReducerClass(Reduce.class);</span><br><span class="line"></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(LongWritable.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputKeyClass(LongWritable.class);</span><br><span class="line">        job.setNumReduceTasks(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Path</span> <span class="variable">outputPath</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Path</span>(OUTPUT_PATH);</span><br><span class="line">        FileInputFormat.setInputPaths(job, <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;hdfs://127.0.0.1:9000/hdp/0317/wordcountinput/&quot;</span>));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, outputPath);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (fileSystem.exists(outputPath)) &#123;</span><br><span class="line">            fileSystem.delete(outputPath, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="literal">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>âš ï¸ <em>è¿è¡Œæ—¶ä¼šæç¤º log4j çš„é…ç½®æœ‰è¯¯ï¼Œè¿è¡Œç¨‹åºå‰éœ€è¦å°† $HADOOP_HOME&#x2F;etc&#x2F;hadoop&#x2F;log4j.properties æ–‡ä»¶å¤åˆ¶åˆ° src&#x2F;main&#x2F;resouces ç›®å½•ä¸‹ã€‚</em></p>
<p>å°†éœ€è¦ç»Ÿè®¡çš„æ–‡æœ¬æ–‡ä»¶ä¸Šä¼ åˆ° hdfs:&#x2F;&#x2F;127.0.0.1:9000&#x2F;hdp&#x2F;0317&#x2F;wordcountinput ç›®å½•ä¸‹ã€‚</p>
<p>åœ¨ Hive ä¸­ç»Ÿè®¡è¯é¢‘ï¼š</p>
<p>1ã€å°†æ–‡æœ¬æ–‡ä»¶ä¸Šä¼ åˆ° hdfs ä¸­</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -put ~/Desktop/wordcount.txt /hdp/0317/wordcountinput</span><br></pre></td></tr></table></figure>

<p>2ã€å°† hdfs ä¸­çš„æ•°æ®æ’å…¥åˆ° Hive è¡¨ä¸­</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> load data inpath <span class="string">&#x27;/hdp/0317/wordcountinput/wordcount.txt&#x27;</span> docs</span><br></pre></td></tr></table></figure>

<p>3ã€HiveQL æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tmp.word, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> cnt</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">	<span class="keyword">select</span> explode(split(line, <span class="string">&#x27; &#x27;</span>)) <span class="keyword">as</span> word</span><br><span class="line">  <span class="keyword">from</span> docs</span><br><span class="line">) tmp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> tmp.word</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> cnt;</span><br></pre></td></tr></table></figure>



<h2 id="Hive-å‘½ä»¤"><a href="#Hive-å‘½ä»¤" class="headerlink" title="Hive å‘½ä»¤"></a>Hive å‘½ä»¤</h2><p>æ‰§è¡Œ <code>hive --help</code> æŸ¥çœ‹ Hive å‘½ä»¤åˆ—è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>cli</td>
<td>å‘½ä»¤è¡Œç•Œé¢</td>
<td>è¿›å…¥å‘½ä»¤è¡Œã€‚</td>
</tr>
<tr>
<td>hwi</td>
<td>Hive Web ç•Œé¢</td>
<td>å¯ä»¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥å’Œå…¶ä»–å‘½ä»¤çš„ç®€å• Web ç•Œé¢ã€‚</td>
</tr>
<tr>
<td>metastore</td>
<td></td>
<td>å¯åŠ¨ä¸€ä¸ªæ‰©å±•çš„å…ƒæ•°æ®æœåŠ¡ï¼Œå¯ä»¥ä¾›å¤šå®¢æˆ·ç«¯ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>rcfilecat</td>
<td></td>
<td>ä¸€ä¸ªå¯ä»¥æ‰“å°å‡º RCFile æ ¼å¼æ–‡ä»¶å†…å®¹çš„å·¥å…·</td>
</tr>
</tbody></table>
<h3 id="CLI-é€‰é¡¹"><a href="#CLI-é€‰é¡¹" class="headerlink" title="CLI é€‰é¡¹"></a>CLI é€‰é¡¹</h3><p>ä½¿ç”¨å‘½ä»¤ <code>hive --help --service cli</code> æŸ¥çœ‹ cli é€‰é¡¹ã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>-d | â€“define</td>
<td>å˜é‡æ›¿æ¢</td>
</tr>
<tr>
<td>-e</td>
<td>æ‰§è¡Œå‘½ä»¤è¡Œä¸­çš„ SQL</td>
</tr>
<tr>
<td>-f</td>
<td>ä»æ–‡ä»¶ä¸­æ‰§è¡Œ SQL</td>
</tr>
<tr>
<td>-H</td>
<td>æ‰“å°å¸®åŠ©ä¿¡æ¯</td>
</tr>
<tr>
<td>-h</td>
<td>è¿æ¥ä¸»æœºå</td>
</tr>
<tr>
<td>-i</td>
<td>åˆå§‹åŒ– SQL æ–‡ä»¶</td>
</tr>
<tr>
<td>-p</td>
<td>è¿æ¥ç«¯å£</td>
</tr>
<tr>
<td>-S | -silent</td>
<td>äº¤äº’å¼å‘½ä»¤è¡Œä¸‹å®‰é™æ¨¡å¼</td>
</tr>
<tr>
<td>-v | â€“verbose</td>
<td>è¾“å‡ºè°ƒè¯•ä¿¡æ¯</td>
</tr>
</tbody></table>
<h3 id="Hive-çš„å±æ€§å‘½åç©ºé—´"><a href="#Hive-çš„å±æ€§å‘½åç©ºé—´" class="headerlink" title="Hive çš„å±æ€§å‘½åç©ºé—´"></a>Hive çš„å±æ€§å‘½åç©ºé—´</h3><table>
<thead>
<tr>
<th>å‘½åç©ºé—´</th>
<th>æƒé™</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>hivevar</td>
<td>å¯è¯»å¯å†™</td>
<td>ç”¨æˆ·è‡ªå®šä¹‰å˜é‡</td>
</tr>
<tr>
<td>hiveconf</td>
<td>å¯è¯»å¯å†™</td>
<td>Hive ç›¸å…³çš„é…ç½®</td>
</tr>
<tr>
<td>system</td>
<td>å¯è¯»å¯å†™</td>
<td>Java å®šä¹‰çš„é…ç½®å±æ€§</td>
</tr>
<tr>
<td>env</td>
<td>åªå¯è¯»</td>
<td>Shell ç¯å¢ƒå®šä¹‰çš„ç¯å¢ƒå˜é‡</td>
</tr>
</tbody></table>
<p>å‡ ä¸ªä¾‹å­ğŸŒ°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hivevar --define &amp; <span class="built_in">set</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hive --define foo=bar;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="built_in">set</span> foo;</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">foo=bar;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="built_in">set</span> hivevar:foo=bar2;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">create table tbl_0318(int i, <span class="variable">$&#123;foo&#125;</span> string);</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">desc tbl_0318;</span></span><br><span class="line">OK</span><br><span class="line">i                   	int</span><br><span class="line">bar2                	string</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hiveconf</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºå½“å‰æ‰€åœ¨åº“å</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="built_in">set</span> hiveconf hive.cli.print.current.db=<span class="literal">true</span>;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">system</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="built_in">set</span> system:user.name</span></span><br><span class="line">system:user.name=longkun</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">env</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="built_in">set</span> <span class="built_in">env</span>:HOME</span></span><br><span class="line">env:HOME=/Users/longkun</span><br></pre></td></tr></table></figure>


<h3 id="Hive-ä¸­ä½¿ç”¨ä¸€æ¬¡å‘½ä»¤"><a href="#Hive-ä¸­ä½¿ç”¨ä¸€æ¬¡å‘½ä»¤" class="headerlink" title="Hive ä¸­ä½¿ç”¨ä¸€æ¬¡å‘½ä»¤"></a>Hive ä¸­ä½¿ç”¨ä¸€æ¬¡å‘½ä»¤</h3><p>âœ… å¦‚æœå¸Œæœ›ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªæŸ¥è¯¢ï¼ŒæŸ¥è¯¢ç»“æŸåç«‹å³é€€å‡º cliï¼Œå¯ä»¥ä½¿ç”¨ -e é€‰é¡¹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hive --service cli -e <span class="string">&quot;select * from db_0316.docs where 1 = 1&quot;</span>;</span></span><br></pre></td></tr></table></figure>

<p>âœ… è¿˜å¯ä»¥å°†è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hive --service cli -e <span class="string">&quot;select * from db_0316.docs where 1 = 1&quot;</span> &gt; ~/Desktop/hive_tmp_result.txt</span></span><br></pre></td></tr></table></figure>

<p>âœ… å½“è®°ä¸æ¸…æ¥šæŸä¸ªå±æ€§åæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ grep ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hive -S -e <span class="string">&quot;set&quot;</span> | grep current.db</span></span><br><span class="line">hive.cli.print.current.db=false</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hive -S -e <span class="string">&quot;set&quot;</span> | grep warehouse</span></span><br><span class="line">hive.metastore.warehouse.dir=/user/hive/warehouse</span><br></pre></td></tr></table></figure>


<h3 id="ä»æ–‡ä»¶ä¸­æ‰§è¡ŒæŸ¥è¯¢"><a href="#ä»æ–‡ä»¶ä¸­æ‰§è¡ŒæŸ¥è¯¢" class="headerlink" title="ä»æ–‡ä»¶ä¸­æ‰§è¡ŒæŸ¥è¯¢"></a>ä»æ–‡ä»¶ä¸­æ‰§è¡ŒæŸ¥è¯¢</h3><p>å¯ä»¥ä½¿ç”¨ -f é€‰é¡¹ä»æ–‡ä»¶ä¸­æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªæŸ¥è¯¢è¯­å¥ï¼Œæ–‡ä»¶å°½é‡ä½¿ç”¨ .q æˆ–è€… .hql åç¼€ã€‚</p>
<p>æ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ query.hqlï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from db_0316.docs</span><br><span class="line">where 1 = 1;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰§è¡ŒæŸ¥è¯¢</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hive -S -f query.hql</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨ cli ä¸­å¯ä»¥ä½¿ç”¨ <span class="built_in">source</span> å‘½ä»¤æ¥æ‰§è¡Œæ–‡ä»¶ä¸­çš„æŸ¥è¯¢è¯­å¥</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="built_in">source</span> ~/Documents/Hive/query.hql</span></span><br></pre></td></tr></table></figure>


<h3 id="hivercæ–‡ä»¶"><a href="#hivercæ–‡ä»¶" class="headerlink" title="hivercæ–‡ä»¶"></a>hivercæ–‡ä»¶</h3><p>-i é€‰é¡¹æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯æ¬¡ CLI å¯åŠ¨æ—¶ä¼šå…ˆæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚Hive ä¼šåœ¨å½“å‰ç›®å½•ä¸‹å¯»æ‰¾ .hiverc æ–‡ä»¶å¹¶æ‰§è¡Œã€‚ç¼–è¾‘ $HIVE_HOME&#x2F;.hiverc æ–‡ä»¶ï¼Œæ·»åŠ å‡ ä¸ªæ¯”è¾ƒå®ç”¨çš„å˜é‡ï¼ˆâš ï¸ åˆ†å·æ˜¯å¿…é¡»çš„ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set hive.cli.print.current.db=true;</span><br><span class="line">set hive.cli.print.header=true;</span><br><span class="line">set hive.exec.mode.local.auto=true;</span><br></pre></td></tr></table></figure>

<p>âœ… <em>ä½¿ç”¨ tab é”®å¯ä»¥è¡¥å…¨å…³é”®å­—æˆ–è€…å‡½æ•°åã€‚</em></p>
<h3 id="æ‰§è¡Œ-shell-å‘½ä»¤"><a href="#æ‰§è¡Œ-shell-å‘½ä»¤" class="headerlink" title="æ‰§è¡Œ shell å‘½ä»¤"></a>æ‰§è¡Œ shell å‘½ä»¤</h3><p>æ— éœ€é€€å‡º cli å³å¯æ‰§è¡Œç®€å•çš„ shell å‘½ä»¤ï¼Œåªéœ€è¦åœ¨ shell å‘½ä»¤å‰åŠ ä¸Š ! ï¼Œå¹¶ä¸”ä»¥ ; ç»“å°¾ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; !pwd;</span><br><span class="line">/Users/longkun</span><br></pre></td></tr></table></figure>


<h3 id="åœ¨-Hive-å†…ä½¿ç”¨-dfs-å‘½ä»¤"><a href="#åœ¨-Hive-å†…ä½¿ç”¨-dfs-å‘½ä»¤" class="headerlink" title="åœ¨ Hive å†…ä½¿ç”¨ dfs å‘½ä»¤"></a>åœ¨ Hive å†…ä½¿ç”¨ dfs å‘½ä»¤</h3><p>ç”¨æˆ·å¯ä»¥åœ¨ cli ä¸­æ‰§è¡Œ Hadoop  çš„ dfs å‘½ä»¤ï¼Œåªéœ€è¦å°† hdfs å»æ‰ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; dfs -ls /;</span><br><span class="line">Found 3 items</span><br><span class="line">drwxr-xr-x   - longkun supergroup          0 2022-03-17 23:54 /hdp</span><br><span class="line">drwx-wx-wx   - longkun supergroup          0 2022-03-18 00:52 /tmp</span><br><span class="line">drwxr-xr-x   - longkun supergroup          0 2022-03-16 21:50 /user</span><br></pre></td></tr></table></figure>

<p><em>æ®è¯´è¿™ç§æ–¹å¼æ¯”åœ¨ bash shell ä¸­æ‰§è¡Œ hdfs dfs â€¦ æ›´é«˜æ•ˆï¼Œå› ä¸ºåè€…ä¼šæ¯æ¬¡å¯åŠ¨ä¸€ä¸ª JVM å®ä¾‹ï¼Œè€Œ Hive ä¼šåœ¨åŒä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œã€‚</em></p>
<h2 id="æ•°æ®ç±»å‹å’Œæ–‡ä»¶æ ¼å¼"><a href="#æ•°æ®ç±»å‹å’Œæ–‡ä»¶æ ¼å¼" class="headerlink" title="æ•°æ®ç±»å‹å’Œæ–‡ä»¶æ ¼å¼"></a>æ•°æ®ç±»å‹å’Œæ–‡ä»¶æ ¼å¼</h2><h3 id="byteã€Byteã€bitã€å­—èŠ‚"><a href="#byteã€Byteã€bitã€å­—èŠ‚" class="headerlink" title="byteã€Byteã€bitã€å­—èŠ‚"></a>byteã€Byteã€bitã€å­—èŠ‚</h3><ul>
<li><p>bit</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bit å³æ˜¯ä½ï¼Œè¡¨ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼Œ0 æˆ– 1ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>byte</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Java çš„åŸºæœ¬æ•°æ®ç±»å‹ä¹‹ä¸€ï¼Œå­˜å‚¨æ•´å½¢ï¼ŒByte æ˜¯å…¶åŒ…è£…ç±»ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>Byte</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Byte è¡¨ç¤ºå­—èŠ‚ï¼Œ1 Byte = 8 bit</span><br></pre></td></tr></table></figure>

<p>Hive ä¸­çš„æ•°æ®ç±»å‹éƒ½æ¥æºäº Java ä¸­çš„æ•°æ®ç±»å‹ã€‚</p>
</li>
</ul>
<h3 id="Hive-ä¸­çš„æ•°æ®ç±»å‹"><a href="#Hive-ä¸­çš„æ•°æ®ç±»å‹" class="headerlink" title="Hive ä¸­çš„æ•°æ®ç±»å‹"></a>Hive ä¸­çš„æ•°æ®ç±»å‹</h3><table>
<thead>
<tr>
<th>æ•°æ®ç±»å‹</th>
<th>é•¿åº¦</th>
<th>ä¾‹å­ğŸŒ°</th>
</tr>
</thead>
<tbody><tr>
<td>TINYINT</td>
<td>1byte æœ‰ç¬¦å·æ•´æ•°</td>
<td>20</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2byte æœ‰ç¬¦å·æ•´æ•°</td>
<td>20</td>
</tr>
<tr>
<td>INT</td>
<td>4byte æœ‰ç¬¦å·æ•´æ•°</td>
<td>20</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8byte æœ‰ç¬¦å·æ•´æ•°</td>
<td>20</td>
</tr>
<tr>
<td>BOOLEAN</td>
<td>boolç±»å‹ï¼Œtrue æˆ–è€… false</td>
<td>TRUE</td>
</tr>
<tr>
<td>FLOAT</td>
<td>å•ç²¾åº¦æµ®ç‚¹å‹</td>
<td>3.1315</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>åŒç²¾åº¦æµ®ç‚¹å‹</td>
<td>3.1415</td>
</tr>
<tr>
<td>STRING</td>
<td>å­—ç¬¦åºåˆ—ï¼Œå¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·</td>
<td>â€˜zhang sanâ€™  â€œwang erâ€</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>æ•´æ•°ã€æµ®ç‚¹æˆ–è€…å­—ç¬¦ä¸²</td>
<td>Unixæ–°çºªå…ƒç§’ï¼ŒUnixæ–°çºªå…ƒç§’åŠçº³ç§’ï¼ŒJDBCæ—¶é—´æ ¼å¼</td>
</tr>
<tr>
<td>BINARY</td>
<td>å­—èŠ‚æ•°ç»„</td>
<td>å’Œå…³ç³»å‹æ•°æ®åº“ä¸­ VARNIBARYç±»ä¼¼ï¼Ÿæ²¡çœ‹æ‡‚</td>
</tr>
</tbody></table>
<p><em>å•ç²¾åº¦å’ŒåŒç²¾åº¦æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå•å’ŒåŒæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</em></p>
<p>å•ç²¾åº¦ï¼š1ä½ç¬¦å·ï¼Œ8ä½æŒ‡æ•°ï¼Œ23ä½å°æ•°ã€‚</p>
<p><img src="https://pic1.zhimg.com/80/v2-749cc641eb4d5dafd085e8c23f8826aa_1440w.jpg?source=1940ef5c" alt="å•ç²¾åº¦è¡¨ç¤º"></p>
<p>åŒç²¾åº¦ï¼š1ä½ç¬¦å·ï¼Œ11ä½æŒ‡æ•°ï¼Œ52ä½å°æ•°ã€‚</p>
<p><img src="https://pic2.zhimg.com/80/v2-48240f0e1e0dd33ec89100cbe2d30707_1440w.jpg?source=1940ef5c" alt="åŒç²¾åº¦è¡¨ç¤º"></p>
<p>è¿˜æ˜¯æ²¡è§£é‡Š å• å’Œ åŒ çš„æ„æ€ã€‚ã€‚</p>
<h3 id="é›†åˆç±»å‹"><a href="#é›†åˆç±»å‹" class="headerlink" title="é›†åˆç±»å‹"></a>é›†åˆç±»å‹</h3><blockquote>
<p>Hive ä¸­æ”¯æŒ structã€map å’Œ array é›†åˆæ•°æ®ç±»å‹ã€‚</p>
</blockquote>
<table>
<thead>
<tr>
<th>æ•°æ®ç±»å‹</th>
<th>æè¿°</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>STRUCT</td>
<td>ä¸å¯¹è±¡ç±»ä¼¼ï¼Œå¯ä»¥é€šè¿‡ . è®¿é—®å…ƒç´ å†…å®¹</td>
<td>struct{first string, last string}</td>
</tr>
<tr>
<td>MAP</td>
<td>é”®å€¼å¯¹</td>
<td>map(â€˜firstâ€™, â€˜johnâ€™, â€˜lastâ€™, â€˜doeâ€™)</td>
</tr>
<tr>
<td>ARRAY</td>
<td>å…·æœ‰ç›¸åŒç±»å‹çš„å˜é‡é›†åˆ</td>
<td>array(â€˜firstâ€™, â€˜lastâ€™)</td>
</tr>
</tbody></table>
<p>å»ºè¡¨è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> db_0320.tbl_person;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> db_0320.person;</span><br><span class="line"><span class="keyword">create table</span> db_0320.tbl_person (</span><br><span class="line">	name string comment <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">	age <span class="type">float</span> comment <span class="string">&#x27;age&#x27;</span>,</span><br><span class="line">	location string comment <span class="string">&#x27;location&#x27;</span>,</span><br><span class="line">	friends <span class="keyword">array</span><span class="operator">&lt;</span>string<span class="operator">&gt;</span> comment <span class="string">&#x27;friends&#x27;</span>,</span><br><span class="line">	score map<span class="operator">&lt;</span>string, <span class="keyword">double</span><span class="operator">&gt;</span> comment <span class="string">&#x27;score&#x27;</span>,</span><br><span class="line">	address struct<span class="operator">&lt;</span>number: tinyint, street: string, city: string<span class="operator">&gt;</span></span><br><span class="line">)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;\001&#x27;</span></span><br><span class="line">collection terminated <span class="keyword">by</span> <span class="string">&#x27;\002&#x27;</span></span><br><span class="line">map keys terminated <span class="keyword">by</span> <span class="string">&#x27;\003&#x27;</span></span><br><span class="line">lines terminated <span class="keyword">by</span> <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">stored <span class="keyword">as</span> textfile;</span><br></pre></td></tr></table></figure>



<h2 id="HiveQL-æ•°æ®å®šä¹‰"><a href="#HiveQL-æ•°æ®å®šä¹‰" class="headerlink" title="HiveQL æ•°æ®å®šä¹‰"></a>HiveQL æ•°æ®å®šä¹‰</h2><h3 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h3><ul>
<li>HiveQL å’Œ MySQL æ¯”è¾ƒæ¥è¿‘ï¼Œä½†ä¹Ÿæœ‰è¾ƒå¤§å·®å¼‚</li>
<li>Hive ä¸æ”¯æŒè¡Œçº§æ’å…¥ã€æ›´æ–°åŠåˆ é™¤æ“ä½œ</li>
<li>Hive ä¸æ”¯æŒäº‹åŠ¡</li>
<li>å¤§å¤šæ•°æƒ…å†µä¸‹ HiveQL å’Œå…¶ä»– SQL å¾ˆåƒ</li>
<li>æŸ¥è¯¢ã€åˆ†ç»„ã€è¿‡æ»¤åŠè¿æ¥</li>
</ul>
<h3 id="å¸¸è§æŸ¥è¯¢"><a href="#å¸¸è§æŸ¥è¯¢" class="headerlink" title="å¸¸è§æŸ¥è¯¢"></a>å¸¸è§æŸ¥è¯¢</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ–°å»ºæ•°æ®åº“</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">create</span> database db_test;</span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> db_test;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥çœ‹æ‰€æœ‰çš„åº“</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">show</span> databases;</span><br><span class="line"><span class="comment">-- ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ä»¥ db_ å¼€å¤´ çš„æ‰€æœ‰æ•°æ®åº“</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">show</span> databases <span class="keyword">like</span> <span class="string">&#x27;db_*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥çœ‹åº“é‡Œçš„è¡¨</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">show</span> tables <span class="keyword">from</span> db_test;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ åº“ï¼ˆåˆ åº“ä¹‹å‰å¿…é¡»å…ˆåˆ é™¤åº“ä¸­çš„è¡¨ï¼Œæˆ–è€…ä½¿ç”¨å…³é”®å­— CASCADEï¼‰</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">drop</span> database if <span class="keyword">exists</span> db_test cascade;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥çœ‹è¡¨å±æ€§</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">desc</span> formatted tbl_test;</span><br><span class="line"><span class="comment">-- å¦‚æœåªæƒ³æŸ¥çœ‹æŸä¸€åˆ—çš„ä¿¡æ¯ï¼Œåªéœ€åœ¨è¡¨ååå¢åŠ è¿™ä¸€åˆ—çš„åç§°å³å¯ï¼ˆäº²æµ‹æŠ¥é”™ï¼šmissing EOF at &#x27;.&#x27; near &#x27;tbl_person&#x27;ï¼‰</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">describe</span> db_0320.tbl_person.score;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ‹·è´ä¸€å¼ å·²å­˜åœ¨çš„è¡¨</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">create table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> tbl_test1 <span class="keyword">like</span> tbl_test;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨ï¼ˆMANAGED-TABLE-EXTERNAL-TABLEï¼‰"><a href="#å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨ï¼ˆMANAGED-TABLE-EXTERNAL-TABLEï¼‰" class="headerlink" title="å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨ï¼ˆMANAGED_TABLE &amp; EXTERNAL_TABLEï¼‰"></a>å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨ï¼ˆMANAGED_TABLE &amp; EXTERNAL_TABLEï¼‰</h3><p>ä½¿ç”¨ EXTERNAL åˆ›å»ºçš„è¡¨æ˜¯å¤–éƒ¨è¡¨ï¼Œå¦åˆ™å°±æ˜¯å†…éƒ¨è¡¨ã€‚å†…éƒ¨è¡¨é»˜è®¤å­˜å‚¨åœ¨ user&#x2F;hive&#x2F;warehouse&#x2F;ä¸‹ï¼Œ å½“åˆ é™¤ä¸€ä¸ªè¡¨æ—¶ï¼ŒHive ä¼šåˆ é™¤è¯¥ç›®å½•ä¸‹å­˜å‚¨çš„æ•°æ®ï¼›è€Œåˆ é™¤å¤–éƒ¨è¡¨æ—¶ï¼Œåªä¼šåˆ é™¤è¡¨çš„å…ƒæ•°æ®ï¼Œä¸ä¼šåˆ é™¤è¡¨æ•°æ®ã€‚ä¸¥æ ¼è¯´ï¼ŒHive ç®¡ç†ç€è¿™ä¹ˆç›®å½•å’Œæ–‡ä»¶ï¼Œä½†æ˜¯ä¸å¯¹å…¶æ‹¥æœ‰å®Œå…¨æ§åˆ¶æƒã€‚</p>
<p>å¤–éƒ¨è¡¨ç¤ºä¾‹ï¼š</p>
<p>1ã€å…ˆå»ºç«‹ä¸€ä¸ªç›®å½•ï¼Œå­˜æ”¾å¤–éƒ¨è¡¨è¦æ“ä½œçš„æ•°æ®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">dfs -<span class="built_in">mkdir</span> /hdp/0322</span></span><br></pre></td></tr></table></figure>

<p>2ã€å»ºè¡¨å¹¶æŒ‡å‘å¤–éƒ¨è¡¨ç©ºé—´</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists db_0320.ex_tbl_student;</span><br><span class="line"></span><br><span class="line">create external table if not exists db_0320.ex_tbl_student (</span><br><span class="line">	name string comment &#x27;name&#x27;,</span><br><span class="line">	age float comment &#x27;age&#x27;,</span><br><span class="line">	class string comment &#x27;class&#x27;</span><br><span class="line">)</span><br><span class="line">row format</span><br><span class="line">delimited fields terminated by &#x27;,&#x27;</span><br><span class="line">location &#x27;/hdp/0322/&#x27;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3ã€å‡†å¤‡æ•°æ®å¹¶ä¸Šä¼ è‡³ HDFS</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">dfs -put ~/Documents/ex_tbl_student.txt /hdp/0323/</span></span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zhangsan,12,ä¸€ç­</span><br><span class="line">lisi,14,äºŒç­</span><br><span class="line">wangwu,16,ä¸‰ç­</span><br></pre></td></tr></table></figure>

<p>4ã€å°†æ•°æ®å¯¼å…¥å¤–éƒ¨è¡¨ä¸­</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">load data inpath <span class="string">&#x27;/hdp/0323/ex_tbl_student.txt&#x27;</span> overwrite into table db_0320.ex_tbl_student;</span></span><br></pre></td></tr></table></figure>

<p>5ã€ç¡®è®¤æ•°æ®åŠæ“ä½œ</p>
<h2 id="åˆ†åŒºè¡¨å’Œç®¡ç†è¡¨"><a href="#åˆ†åŒºè¡¨å’Œç®¡ç†è¡¨" class="headerlink" title="åˆ†åŒºè¡¨å’Œç®¡ç†è¡¨"></a>åˆ†åŒºè¡¨å’Œç®¡ç†è¡¨</h2><p>åˆ†åŒºå°†æ•°æ®åˆ†æ•£åœ¨å¤šä¸ªç›®å½•ä¸‹ï¼Œå¯ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<p>å¦‚æœè¡¨ä¸­æ•°æ®æˆ–è€…åˆ†åŒºä¸­çš„æ•°æ®é‡å·¨å¤§ï¼Œæ‰§è¡Œä¸€ä¸ªåŒ…å«æ‰€æœ‰åˆ†åŒºçš„æŸ¥è¯¢ä¼šå‡ºå‘å·¨å¤§çš„ MR ä»»åŠ¡ï¼Œå¯ä»¥å°† <code>hive.mapred.mode=strict</code> è®¾ç½®æˆä¸¥æ ¼æ¨¡å¼ç¦æ­¢æäº¤ä»»åŠ¡ã€‚</p>
<p>åˆ›å»ºåˆ†åŒºè¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> db_0322.tbl_student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> db_0322.tbl_student (</span><br><span class="line">	name string comment <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">	age <span class="type">float</span> comment <span class="string">&#x27;age&#x27;</span>,</span><br><span class="line">	class string comment <span class="string">&#x27;class&#x27;</span></span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">by</span> (grade string comment <span class="string">&#x27;grade&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹åˆ†åŒºï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">desc partitions db_0322.tbl_student;</span></span><br></pre></td></tr></table></figure>

<p>å¯¼å…¥æ•°æ®è‡³åˆ†åŒºè¡¨ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; load data inpath <span class="string">&#x27;tbl_student.txt&#x27;</span> overwrite into table tbl_student partition (grade=<span class="string">&#x27;grade2&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>ä¸ºå¤–éƒ¨åˆ†åŒºè¡¨å¢åŠ ä¸€ä¸ªåˆ†åŒºï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> log <span class="keyword">add</span> <span class="keyword">partition</span>(<span class="keyword">year</span><span class="operator">=</span><span class="number">2012</span>, <span class="keyword">month</span><span class="operator">=</span><span class="number">1</span>, <span class="keyword">day</span><span class="operator">=</span><span class="number">1</span>);</span><br></pre></td></tr></table></figure>



<h2 id="å¯¹è¡¨çš„æ“ä½œ"><a href="#å¯¹è¡¨çš„æ“ä½œ" class="headerlink" title="å¯¹è¡¨çš„æ“ä½œ"></a>å¯¹è¡¨çš„æ“ä½œ</h2><p>åˆ é™¤è¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> db_0323.tbl_test;</span><br></pre></td></tr></table></figure>

<p><em>å¯ä»¥äº†è§£ä¸‹ Hive çš„å›æ”¶ç«™åŠŸèƒ½ã€‚</em></p>
<p>ä¿®æ”¹è¡¨ï¼šå¯ä»¥ä½¿ç”¨ alter table è¯­å¥ä¿®æ”¹è¡¨ï¼Œè¿™ç§æ–¹å¼ä¼š<strong>ä¿®æ”¹è¡¨çš„å…ƒæ•°æ®ï¼Œä¸ä¼šä¿®æ”¹æ•°æ®æœ¬èº«ã€‚</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- é‡å‘½åè¡¨</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> tbl_test rename <span class="keyword">to</span> tbl_test1;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¢åŠ åˆ†åŒºï¼Œç»™æ²¡æœ‰åˆ†åŒºçš„è¡¨æ·»åŠ åˆ†åŒºä¼šæŠ¥é”™</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> tbl_test <span class="keyword">add</span> if <span class="keyword">not</span> <span class="keyword">exists</span> <span class="keyword">partition</span> (city<span class="operator">=</span><span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤åˆ†åŒº</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> tbl_test2 <span class="keyword">drop</span> if <span class="keyword">exists</span> <span class="keyword">partition</span> (city <span class="operator">=</span> <span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹å­—æ®µ</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> tbl_test2 change <span class="keyword">column</span> name username string comment <span class="string">&#x27;username&#x27;</span> after column1;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ–°å¢ä¸€ä¸ªå­—æ®µ</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> tbl_test1 <span class="keyword">add</span> columns (age <span class="type">float</span> comment <span class="string">&#x27;age&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹è¡¨å±æ€§</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> tbl_test1 <span class="keyword">set</span> tblproperties (<span class="string">&#x27;note&#x27;</span><span class="operator">=</span><span class="string">&#x27;test note....&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ‰§è¡Œé’©å­ï¼Œå½“å¾€è¡¨ä¸­å†™å…¥æ•°æ®æ—¶è§¦å‘æ‰§è¡Œ</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> tbl_test touch <span class="keyword">partition</span>(<span class="keyword">year</span><span class="operator">=</span><span class="number">2021</span>, <span class="keyword">month</span><span class="operator">=</span><span class="number">12</span>, <span class="keyword">day</span><span class="operator">=</span><span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å°†åˆ†åŒºå†…çš„æ–‡ä»¶æ‰“åŒ…æˆ Hadoop å‹ç¼©åŒ…ï¼ˆHARï¼‰ï¼Œä½¿ç”¨ unarchive åå‘æ“ä½œ</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> ... archive <span class="keyword">partition</span> (<span class="keyword">year</span>, <span class="keyword">month</span>, <span class="keyword">day</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- é˜²æ­¢åˆ†åŒºè¢«ä¿®æ”¹æˆ–åˆ é™¤ï¼ˆæŠ¥é”™ï¼‰</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">alter table</span> tbl_test <span class="keyword">partition</span> (<span class="keyword">year</span><span class="operator">=</span><span class="number">2021</span>, <span class="keyword">month</span><span class="operator">=</span><span class="number">10</span>, <span class="keyword">day</span><span class="operator">=</span><span class="number">1</span>) enable no_drop;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="HiveQL-æ•°æ®æ“ä½œ"><a href="#HiveQL-æ•°æ®æ“ä½œ" class="headerlink" title="HiveQL æ•°æ®æ“ä½œ"></a>HiveQL æ•°æ®æ“ä½œ</h2><p>Hive ä¸æ”¯æŒè¡Œçº§æ•°æ®æ’å…¥ã€æ›´æ–°åŠåˆ é™¤ï¼Œåªèƒ½é€šè¿‡å¤§æ‰¹é‡çš„æ–¹å¼å°†æ•°æ®å¯¼å…¥è¡¨ä¸­ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> load data <span class="keyword">local</span> inpath <span class="string">&#x27;$&#123;env:HOME&#125;/data&#x27;</span> overwrite <span class="keyword">into</span> <span class="keyword">table</span> tbl_test <span class="keyword">partition</span> (<span class="keyword">year</span> <span class="operator">=</span> <span class="number">2022</span>, <span class="keyword">month</span> <span class="operator">=</span> <span class="number">3</span>, <span class="keyword">day</span> <span class="operator">=</span> <span class="number">22</span>);</span><br></pre></td></tr></table></figure>

<p><em>local è¡¨ç¤ºæœ¬åœ°ç›®å½•ï¼Œå¦‚æœä¸åŠ  local åˆ™è¡¨ç¤º hdfs ä¸Šçš„æ–‡ä»¶ã€‚</em></p>
<p>Hive ä¸ä¼šæ ¡éªŒå¯¼å…¥çš„æ•°æ®å’Œè¡¨çš„æ¨¡å¼æ˜¯å¦åŒ¹é…ï¼Œä½†æ˜¯ä¼šæ ¡éªŒæ–‡ä»¶æ ¼å¼æ˜¯å¦å’Œè¡¨çš„å®šä¹‰ä¸€è‡´ã€‚</p>
<p>é€šè¿‡æŸ¥è¯¢å‘è¡¨ä¸­å¯¼å…¥æ•°æ®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">use db_0323;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tbl_test3_tmp tmp</span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">table</span> tbl_test3</span><br><span class="line">    <span class="keyword">partition</span> (city <span class="operator">=</span> <span class="string">&#x27;Beijing&#x27;</span>)</span><br><span class="line">    <span class="keyword">select</span> name <span class="keyword">where</span> tmp.city <span class="operator">=</span> <span class="string">&#x27;Beijing&#x27;</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">table</span> tbl_test3</span><br><span class="line">    <span class="keyword">partition</span> (city <span class="operator">=</span> <span class="string">&#x27;Tianjin&#x27;</span>)</span><br><span class="line">    <span class="keyword">select</span> name <span class="keyword">where</span> tmp.city <span class="operator">=</span> <span class="string">&#x27;Tianjin&#x27;</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">table</span> tbl_test3</span><br><span class="line">    <span class="keyword">partition</span> (city <span class="operator">=</span> <span class="string">&#x27;Tianjing&#x27;</span>)</span><br><span class="line">    <span class="keyword">select</span> name <span class="keyword">where</span> tmp.city <span class="operator">=</span> <span class="string">&#x27;Tianjing&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸€ä¸ªåˆ†åŒºä¸€ä¸ªåˆ†åŒºçš„æŸ¥å‡ºæ¥å†å¯¼å…¥çš„è¯ï¼Œä¼šéå¸¸ç¹çï¼Œå¯ä»¥ä½¿ç”¨åŠ¨æ€åˆ†åŒºæ’å…¥æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use db_0323;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">table</span> tbl_test3</span><br><span class="line"><span class="keyword">select</span> name, city</span><br><span class="line"><span class="keyword">from</span> tbl_test3_tmp;</span><br></pre></td></tr></table></figure>

<p><em>æœ€åçš„å‡ åˆ—é¡ºåºè¦å’Œåˆ†åŒºå­—æ®µä¸€è‡´ï¼ŒHive æ ¹æ®åˆ—ä½ç½®æ¥ç¡®å®šåˆ†åŒºå­—æ®µï¼Œè€Œä¸æ˜¯åç§°ã€‚å¹¶ä¸”é™æ€åˆ†åŒºå­—æ®µå¿…é¡»ä½äºåŠ¨æ€åˆ†åŒºå­—æ®µä¹‹å‰ã€‚</em></p>
<p><code>dfs -ls /user/hive/warehouse/db_0323.db/tbl_test3</code> æŸ¥çœ‹åˆ†åŒºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Found 3 items</span><br><span class="line">drwxr-xr-x   - longkun supergroup          0 2022-03-24 23:56 /user/hive/warehouse/db_0323.db/tbl_test3/city=Beijing</span><br><span class="line">drwxr-xr-x   - longkun supergroup          0 2022-03-24 23:56 /user/hive/warehouse/db_0323.db/tbl_test3/city=Tianjin</span><br><span class="line">drwxr-xr-x   - longkun supergroup          0 2022-03-24 23:56 /user/hive/warehouse/db_0323.db/tbl_test3/city=Tianjing</span><br></pre></td></tr></table></figure>

<p>åŠ¨æ€åˆ†åŒºåŠŸèƒ½é»˜è®¤æ˜¯å…³é—­çš„ã€‚å¼€å¯åï¼Œé»˜è®¤ä»¥â€œä¸¥æ ¼â€æ¨¡å¼æ‰§è¡Œï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼Œè¦æ±‚è‡³å°‘æœ‰ä¸€åˆ—å­—æ®µæ˜¯é™æ€åˆ†åŒºï¼Œæœ‰åŠ©äºé˜²æ­¢å› è®¾è®¡é”™è¯¯å¯¼è‡´äº§ç”Ÿå¤§é‡çš„åˆ†åŒºã€‚</p>
<p>åŠ¨æ€åˆ†åŒºç›¸å…³å±æ€§ï¼š</p>
<table>
<thead>
<tr>
<th>å±æ€§åç§°</th>
<th>ç¼ºçœå€¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>hive.exec.dynamic.partition</td>
<td>false</td>
<td>è®¾ç½®æˆ trueï¼Œå¼€å¯åŠ¨æ€åˆ†åŒºåŠŸèƒ½</td>
</tr>
<tr>
<td>hive.exec.dynamic.partition.mode</td>
<td>strict</td>
<td>è®¾ç½®æˆ no strictï¼Œå…è®¸æ‰€æœ‰åˆ—éƒ½æ˜¯åŠ¨æ€åˆ†åŒº</td>
</tr>
<tr>
<td>hive.exec.max.dynamic.partitions.pernode</td>
<td>100</td>
<td>æ¯ä¸ª mapper å’Œ reducer å¯ä»¥åˆ›å»ºçš„æœ€å¤§åˆ†æ•°ï¼Œè¶…è¿‡ä¼šæŠ¥é”™</td>
</tr>
<tr>
<td>hive.exec.max.dynamic.partitions</td>
<td>1000</td>
<td>ä¸€ä¸ªåŠ¨æ€åˆ†åŒºè¯­å¥å¯ä»¥åˆ›å»ºçš„æœ€å¤§åŠ¨æ€åˆ†åŒºä¸ªæ•°ï¼Œè¶…è¿‡ä¼šæŠ¥é”™</td>
</tr>
<tr>
<td>hive.exec.max.created.files</td>
<td>100000</td>
<td>å…¨å±€å¯ä»¥åˆ›å»ºçš„æœ€å¤§æ–‡ä»¶ä¸ªæ•°ï¼Œè¶…è¿‡ä¼šæŠ¥é”™</td>
</tr>
</tbody></table>
<p>å•ä¸ªæŸ¥è¯¢è¯­å¥åˆ›å»ºè¡¨å¹¶åŠ è½½æ•°æ®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> tbl_test4 <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> name</span><br><span class="line"><span class="keyword">from</span> tbl_test3</span><br><span class="line"><span class="keyword">where</span> city <span class="operator">=</span> <span class="string">&#x27;Beijing&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>å¯¼å‡ºæ•°æ® <code>insert directory</code>ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">use db_0323;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç¬¬ä¸€ç§æ–¹å¼</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> directory <span class="string">&#x27;$&#123;env:HOME&#125;/Documents/Hive/export&#x27;</span></span><br><span class="line"><span class="keyword">select</span> name, city</span><br><span class="line"><span class="keyword">from</span> tbl_test3</span><br><span class="line"><span class="keyword">where</span> city <span class="operator">=</span> <span class="string">&#x27;Beijing&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç¬¬äºŒç§æ–¹å¼</span></span><br><span class="line"><span class="keyword">from</span> tbl_test3 tmp</span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> directory <span class="string">&#x27;$&#123;env:HOME&#125;/Documents/Hive/export-beijing&#x27;</span></span><br><span class="line">    <span class="keyword">select</span> name <span class="keyword">where</span> tmp.city <span class="operator">=</span> <span class="string">&#x27;Beijing&#x27;</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> directory <span class="string">&#x27;$&#123;env:HOME&#125;/Documents/Hive/export-tianjin&#x27;</span></span><br><span class="line">    <span class="keyword">select</span> name <span class="keyword">where</span> tmp.city <span class="operator">=</span> <span class="string">&#x27;Tianjin&#x27;</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> directory <span class="string">&#x27;$&#123;env:HOME&#125;/Documents/Hive/export-tianjing&#x27;</span></span><br><span class="line">    <span class="keyword">select</span> name <span class="keyword">where</span> tmp.city <span class="operator">=</span> <span class="string">&#x27;Tianjing&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><em>Hive ä¸­æ²¡æœ‰ä¸´æ—¶è¡¨çš„æ¦‚å¿µã€‚</em></p>
<h2 id="HiveQL-æŸ¥è¯¢"><a href="#HiveQL-æŸ¥è¯¢" class="headerlink" title="HiveQL æŸ¥è¯¢"></a>HiveQL æŸ¥è¯¢</h2><h3 id="å¸¸ç”¨å‡½æ•°ï¼š"><a href="#å¸¸ç”¨å‡½æ•°ï¼š" class="headerlink" title="å¸¸ç”¨å‡½æ•°ï¼š"></a>å¸¸ç”¨å‡½æ•°ï¼š</h3><table>
<thead>
<tr>
<th>è¿”å›å€¼ç±»å‹</th>
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>BIGINT</td>
<td>round(double d)</td>
<td>å–è¿‘ä¼¼å€¼</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>round(double d, int n)</td>
<td>å–è¿‘ä¼¼å€¼ï¼Œä¿ç•™ n ä½å°æ•°</td>
</tr>
<tr>
<td>BIGINT</td>
<td>floot(double d)</td>
<td>å‘ä¸‹å–æ•´</td>
</tr>
<tr>
<td>BIGINT</td>
<td>ceil(double d)</td>
<td>å‘ä¸Šå–æ•´</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>rand()</td>
<td>ç”Ÿæˆä¸€ä¸ª DOUBLE ç±»å‹çš„éšæœºæ•°</td>
</tr>
<tr>
<td>STRING</td>
<td>concat_ws(string separator, string s1, string s2â€¦)</td>
<td>ä½¿ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦è¿æ¥å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>STRING</td>
<td>substr(string s, int start, int length)</td>
<td>æˆªå–å­å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>STRING</td>
<td>to_date(string date)</td>
<td>â€˜2022-01-01 10:20:12â€™ -&gt; â€˜2022-01-01â€™</td>
</tr>
<tr>
<td>INT</td>
<td>year(string date)</td>
<td>è¿”å›å¹´</td>
</tr>
<tr>
<td>INT</td>
<td>month</td>
<td>è·å–æœˆä»½</td>
</tr>
<tr>
<td>INT</td>
<td>date_diff(string date1, string date2)</td>
<td>è·å–ä¸¤ä¸ªæ—¥æœŸç›¸å·®å¤©æ•°</td>
</tr>
<tr>
<td>INT</td>
<td>date_add(string date, int days)</td>
<td>æ—¥æœŸç›¸åŠ </td>
</tr>
<tr>
<td>INT</td>
<td>date_sub(string date, int days)</td>
<td>æ—¥æœŸç›¸å‡</td>
</tr>
</tbody></table>
<h3 id="åµŒå¥—-SELECT"><a href="#åµŒå¥—-SELECT" class="headerlink" title="åµŒå¥— SELECT"></a>åµŒå¥— SELECT</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> (</span><br><span class="line">	<span class="keyword">select</span> name, age</span><br><span class="line">  <span class="keyword">from</span> tbl_test3</span><br><span class="line">  <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">10</span></span><br><span class="line">) tmp</span><br><span class="line"><span class="keyword">select</span> tmp.<span class="operator">*</span></span><br><span class="line"><span class="keyword">where</span> tmp.name <span class="keyword">like</span> <span class="string">&#x27;zhang%&#x27;</span>;</span><br></pre></td></tr></table></figure>


<h3 id="CASE-WHEN"><a href="#CASE-WHEN" class="headerlink" title="CASE WHEN"></a>CASE WHEN</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,</span><br><span class="line">       <span class="keyword">case</span></span><br><span class="line">         <span class="keyword">when</span> age <span class="operator">&lt;</span> <span class="number">18</span> <span class="keyword">then</span> <span class="string">&#x27;æœªæˆå¹´&#x27;</span></span><br><span class="line">         <span class="keyword">when</span> age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">and</span> age <span class="operator">&lt;</span> <span class="number">60</span> <span class="keyword">then</span> <span class="string">&#x27;æˆå¹´&#x27;</span></span><br><span class="line">         <span class="keyword">else</span> <span class="string">&#x27;è€å¹´&#x27;</span></span><br><span class="line">       <span class="keyword">end</span> <span class="keyword">as</span> age,</span><br><span class="line">       sex</span><br><span class="line"> <span class="keyword">from</span> tbl_test;</span><br></pre></td></tr></table></figure>


<h3 id="é¿å…è¿›è¡Œ-MapReduce"><a href="#é¿å…è¿›è¡Œ-MapReduce" class="headerlink" title="é¿å…è¿›è¡Œ MapReduce"></a>é¿å…è¿›è¡Œ MapReduce</h3><ul>
<li>where æ¡ä»¶ä¸­è¿‡æ»¤å­—æ®µæ˜¯åˆ†åŒºå­—æ®µ</li>
<li>æ²¡æœ‰ where æ¡ä»¶çš„ select è¯­å¥</li>
<li>hive.exec.mode.local.auto&#x3D;true ä¼šå°è¯•æœ¬åœ°æ¨¡å¼æ‰§è¡Œå…¶ä»– SQL</li>
</ul>
<h3 id="ç±»å‹è½¬æ¢-cast"><a href="#ç±»å‹è½¬æ¢-cast" class="headerlink" title="ç±»å‹è½¬æ¢ cast"></a>ç±»å‹è½¬æ¢ cast</h3><p><em>æœ€å¥½ä½¿ç”¨ ceil &#x2F; floor &#x2F; round ç­‰å‡½æ•°æ¥å°†å­—ç¬¦ä¸²è½¬ä¸ºæ•´æ•°ã€‚</em></p>
<h3 id="æŠ½æ ·æŸ¥è¯¢"><a href="#æŠ½æ ·æŸ¥è¯¢" class="headerlink" title="æŠ½æ ·æŸ¥è¯¢"></a>æŠ½æ ·æŸ¥è¯¢</h3><p>æŒ‰ç…§ï¼ˆåŸºäºè¡Œæ•°çš„ï¼‰ç™¾åˆ†æ¯”è¿›è¡ŒæŠ½æ ·ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tbl_student_info_tmp <span class="keyword">tablesample</span>(<span class="number">50</span> <span class="keyword">percent</span>);</span><br></pre></td></tr></table></figure>


<h3 id="UNION-ALL"><a href="#UNION-ALL" class="headerlink" title="UNION ALL"></a>UNION ALL</h3><p>å°†å¤šä¸ªå­è¡¨è¿›è¡Œåˆå¹¶ï¼Œè¿™å‡ ä¸ªå­è¡¨çš„åˆ—åŠé¡ºåºåŠç±»å‹å¿…é¡»å®Œå…¨ä¸€è‡´ï¼Œç†è®ºä¸Šå¯ä»¥æ”¹ä¸ºå¤šä¸ª where è¯­å¥ã€‚</p>
<h2 id="HiveQL-è§†å›¾"><a href="#HiveQL-è§†å›¾" class="headerlink" title="HiveQL è§†å›¾"></a>HiveQL è§†å›¾</h2><p>å¯ä»¥ä½¿ç”¨è§†å›¾ç®€åŒ–æŸ¥è¯¢ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ‰€æœ‰æ¥è‡ªåŒ—äº¬çš„å­¦ç”Ÿ</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> view_student_beijing <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> uid, name, age, grade, class</span><br><span class="line"><span class="keyword">from</span> tbl_student_info</span><br><span class="line"><span class="keyword">where</span> home_address.province <span class="operator">=</span> <span class="string">&#x27;åŒ—äº¬&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ¥è‡ªåŒ—äº¬å¹´é¾„å°äº 20 çš„å­¦ç”Ÿ</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> view_student_beijing</span><br><span class="line"><span class="keyword">where</span> <span class="built_in">ceil</span>(age) <span class="operator">&lt;=</span> <span class="number">20</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åˆ é™¤è§†å›¾ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> if <span class="keyword">exists</span> view_student_beijing;</span><br></pre></td></tr></table></figure>

<p><em>è§†å›¾ä¸èƒ½åšä¸º load å’Œ insert çš„ç›®æ ‡è¡¨ã€‚è§†å›¾æ˜¯åªè¯»çš„ï¼Œåªå…è®¸æ”¹å˜ä¸æ•°æ®ä¿¡æ¯ tblpropretiesã€‚</em></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">view</span> <span class="keyword">set</span> tblproperties(<span class="string">&#x27;created_by&#x27;</span><span class="operator">=</span><span class="string">&#x27;system&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h2 id="HiveQL-ç´¢å¼•"><a href="#HiveQL-ç´¢å¼•" class="headerlink" title="HiveQL ç´¢å¼•"></a>HiveQL ç´¢å¼•</h2><h2 id="æ¨¡å¼è®¾è®¡"><a href="#æ¨¡å¼è®¾è®¡" class="headerlink" title="æ¨¡å¼è®¾è®¡"></a>æ¨¡å¼è®¾è®¡</h2><h3 id="åˆ†åŒºè¡¨"><a href="#åˆ†åŒºè¡¨" class="headerlink" title="åˆ†åŒºè¡¨"></a>åˆ†åŒºè¡¨</h3><p>éšç€ç³»ç»Ÿè¿è¡Œæ—¶é—´çš„å¢åŠ ï¼Œè¡¨æ•°æ®é‡ä¼šè¶Šæ¥è¶Šå¤§ï¼ŒHive æŸ¥è¯¢é€šå¸¸æ˜¯å…¨è¡¨æ‰«æï¼Œæ€§èƒ½ä¼šè¶Šæ¥è¶Šä½ã€‚å¯ä»¥ä½¿ç”¨åˆ†åŒºè¡¨æé«˜æ€§èƒ½ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> tbl_test(name string)</span><br><span class="line">partitioned <span class="keyword">by</span> (kind string);</span><br></pre></td></tr></table></figure>

<p>åˆ†åŒºåˆ—åªæ˜¯ä¸€ä¸ªç›®å½•åç§°ï¼Œå®é™…ä¸å­˜å‚¨è¿™ä¸€åˆ—æ•°æ®ã€‚</p>
<p>åº”è¯¥é€‰æ‹©åˆé€‚çš„åˆ†åŒºå­—æ®µï¼Œå¦‚æœåˆ†åŒºæ•°å¤ªå¤§ï¼Œä¼šåˆ›å»ºå¤§é‡çš„ Hadoop æ–‡ä»¶åŠæ–‡ä»¶å¤¹ï¼Œåè€Œä¼šé™ä½æŸ¥è¯¢æ•ˆç‡ã€‚</p>
<p>å¯ä»¥é€‰æ‹©å¤šä¸ªåˆ†åŒºå­—æ®µæ¥è¿›è¡Œåˆ†åŒºã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> student (</span><br><span class="line">	name string,</span><br><span class="line">  sex string</span><br><span class="line">) partitioned <span class="keyword">by</span> (grade string, class string);</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹åˆ†åŒºï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> partitions table_name;</span><br></pre></td></tr></table></figure>


<h3 id="å”¯ä¸€é”®å’Œæ ‡å‡†åŒ–"><a href="#å”¯ä¸€é”®å’Œæ ‡å‡†åŒ–" class="headerlink" title="å”¯ä¸€é”®å’Œæ ‡å‡†åŒ–"></a>å”¯ä¸€é”®å’Œæ ‡å‡†åŒ–</h3><p>Hive æ²¡æœ‰å…³ç³»å‹æ•°æ®åº“ä¸­çš„å”¯ä¸€é”®å’Œåºåˆ—è‡ªå¢ï¼Œåº”é¿å…å¯¹éæ ‡å‡†åŒ–ï¼ˆï¼Ÿï¼‰æ•°æ®è¿›è¡Œ JOIN æ“ä½œï¼Œå¤æ‚çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥é€šè¿‡ Arrayã€Mapã€STRUCT å®ç°ã€‚</p>
<h3 id="åŒä¸€ä»½æ•°æ®å¤„ç†å¤šæ¬¡"><a href="#åŒä¸€ä»½æ•°æ®å¤„ç†å¤šæ¬¡" class="headerlink" title="åŒä¸€ä»½æ•°æ®å¤„ç†å¤šæ¬¡"></a>åŒä¸€ä»½æ•°æ®å¤„ç†å¤šæ¬¡</h3><p>Hive å¯ä»¥ä»ä¸€ä¸ªæ•°æ®æºäº§ç”Ÿå¤šä¸ªæ•°æ®èšåˆï¼Œè€Œæ— éœ€æ¯æ¬¡èšåˆéƒ½é‡æ–°æ‰«æä¸€æ¬¡ï¼Œå¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tbl_student_info_tmp</span><br><span class="line"><span class="keyword">insert</span> overwrite tbl_student_info1 <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">insert</span> overwrite tbl_student_info2 <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>


<h3 id="å¯¹äºæ¯ä¸ªè¡¨çš„åˆ†åŒº"><a href="#å¯¹äºæ¯ä¸ªè¡¨çš„åˆ†åŒº" class="headerlink" title="å¯¹äºæ¯ä¸ªè¡¨çš„åˆ†åŒº"></a>å¯¹äºæ¯ä¸ªè¡¨çš„åˆ†åŒº</h3><p>å¯¹äºä¸€äº›ä¸­é—´æ•°æ®å¯ä»¥ä½¿ç”¨åˆ†åŒºï¼Œå¯ä»¥ä¿è¯ä»»åŠ¡é‡è·‘çš„æ—¶å€™ä¸ä¼šè¦†ç›–æ‰€æœ‰çš„æ•°æ®ï¼Œåªå¯¹ç›®æ ‡æ•°æ®è¿›è¡Œå¤„ç†ã€‚</p>
<p>è¿™å‡ ä¸ªæœˆè´Ÿè´£å…¬å¸ä¸€äº›æ•°æ®çš„å¤„ç†ï¼ŒåŸºæœ¬éƒ½æ˜¯æŒ‰æœˆæ‹‰ç»“æœï¼Œä½¿ç”¨æœˆæœ«çš„æ—¶é—´åšä¸ºåˆ†åŒºï¼Œè¿™æ ·æ¯ä¸€ä¸ªæœˆçš„æ•°æ®éƒ½å¯ä»¥ç•™å­˜ä¸‹æ¥æˆä¸ºå†å²æ•°æ®ï¼Œä¸å—ä¸‹ä¸ªæœˆæ•°æ®çš„å½±å“ã€‚</p>
<h3 id="åˆ†æ¡¶-ğŸª£"><a href="#åˆ†æ¡¶-ğŸª£" class="headerlink" title="åˆ†æ¡¶ ğŸª£"></a>åˆ†æ¡¶ ğŸª£</h3><p>Hiveè¡¨åˆ†åŒºçš„å®è´¨æ˜¯åˆ†ç›®å½•ï¼ˆå°†è¶…å¤§è¡¨çš„æ•°æ®æŒ‰æŒ‡å®šæ ‡å‡†ç»†åˆ†åˆ°æŒ‡å®šç›®å½•ï¼‰ï¼Œä¸”åˆ†åŒºçš„å­—æ®µä¸å±äºHiveè¡¨ä¸­å­˜åœ¨çš„å­—æ®µï¼›åˆ†æ¡¶çš„å®è´¨æ˜¯åˆ†æ–‡ä»¶ï¼ˆå°†è¶…å¤§æ–‡ä»¶çš„æ•°æ®æŒ‰æŒ‡å®šæ ‡å‡†ç»†åˆ†åˆ°åˆ†æ¡¶æ–‡ä»¶ï¼‰ï¼Œä¸”åˆ†æ¡¶çš„å­—æ®µå¿…é¡»åœ¨Hiveè¡¨ä¸­å­˜åœ¨ã€‚</p>
<p>åˆ†æ¡¶çš„å¥½å¤„åœ¨äºè¡¨ä¸­çš„æ•°æ®å·²ç»æŒ‰æ¡ä»¶åˆ†åˆ°äº†å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œjoin æˆ–è€…å…¶ä»–è®¡ç®—æ—¶åªéœ€å–ç¬¦åˆæ¡ä»¶çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºåˆ†æ¡¶è¡¨</span></span><br><span class="line">use db_0327;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> bucket_tbl_student_info;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> bucket_tbl_student_info (</span><br><span class="line">  uid string comment <span class="string">&#x27;uid&#x27;</span>,</span><br><span class="line">  name string comment <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">  age <span class="type">int</span> comment <span class="string">&#x27;age&#x27;</span></span><br><span class="line">) clustered <span class="keyword">by</span> (age) <span class="keyword">into</span> <span class="number">2</span> buckets</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span></span><br><span class="line">lines terminated <span class="keyword">by</span> <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å°†æ•°æ®å†™å…¥åˆ†æ¡¶è¡¨</span></span><br><span class="line"><span class="keyword">set</span> hiveconf:hive.enforce.bucketing<span class="operator">=</span><span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">use db_0327;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tbl_student_info_tmp</span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">table</span> bucket_tbl_student_info</span><br><span class="line"><span class="keyword">select</span> uid, name, <span class="built_in">floor</span>(age) <span class="keyword">as</span> age <span class="keyword">where</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¦‚æœä¸è®¾ç½®  hiveconf:mapred.reduce.tasksï¼Œåˆ™éœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸åˆ†æ¡¶ä¸ªæ•°ç›¸ç­‰çš„ reducer æ•°</span></span><br><span class="line"><span class="keyword">set</span> hiveconf:mapred.reduce.tasks<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">use db_0327;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tbl_student_info_tmp</span><br><span class="line"><span class="keyword">insert into</span> <span class="keyword">table</span> bucket_tbl_student_info</span><br><span class="line"><span class="keyword">select</span> uid, name, <span class="built_in">floor</span>(age)</span><br><span class="line"><span class="keyword">where</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">cluster <span class="keyword">by</span> age;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä»åˆ†æ¡¶è¡¨ä¸­è·å–æŠ½æ ·æ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> uid, name, age <span class="keyword">from</span> bucket_tbl_student_info <span class="keyword">tablesample</span>(bucket <span class="number">1</span> <span class="keyword">out</span> <span class="keyword">of</span> <span class="number">2</span> <span class="keyword">on</span> age);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>å°† hive.enforce.bucketing è®¾ç½®æˆ true ä¹‹åï¼ŒHive ä¼šåœ¨ç›®æ ‡è¡¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªæ­£ç¡®çš„ reducer æ•°ã€‚</em></p>
<h3 id="ä¸ºè¡¨æ–°å¢åˆ—"><a href="#ä¸ºè¡¨æ–°å¢åˆ—" class="headerlink" title="ä¸ºè¡¨æ–°å¢åˆ—"></a>ä¸ºè¡¨æ–°å¢åˆ—</h3><blockquote>
<p>Hive è¡¨å¯¹æ•°æ®æ ¼å¼çš„è¦æ±‚æ¯”è¾ƒå®½æ¾ï¼Œåˆ—çš„ä¿¡æ¯åœ¨å…ƒæ•°æ®ä¸­ï¼Œæ–°å¢åˆ—æˆ–è€…åˆ é™¤åˆ—åªæ˜¯æ”¹å˜å…ƒæ•°æ®ã€‚å¦‚æœåˆ—çš„ä¸ªæ•°æ¯”å®é™…æ•°æ®çš„åˆ—è¦å¤šï¼Œåˆ™å¤šä½™çš„åˆ—ä¼šè¢«çœç•¥ï¼Œç›¸åï¼Œåˆ™ä¼šä»¥ NULL å¡«å……ã€‚</p>
</blockquote>
<p>Hive è¡¨æ–°å¢åˆ—ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> tbl_access_log <span class="keyword">add</span> columns (rank1 <span class="type">int</span>, rank2 <span class="type">int</span>);</span><br></pre></td></tr></table></figure>

<p>åœ¨æ–°å¢åˆ—ä¹‹å‰å…¥åº“çš„æ•°æ®ï¼ŒæŸ¥è¯¢çš„æ—¶å€™æ–°åŠ çš„å­—æ®µä¼šç”¨ NULL å¡«å……ã€‚</p>
<h3 id="ä½¿ç”¨åˆ—å­˜å‚¨è¡¨-ğŸ“¦"><a href="#ä½¿ç”¨åˆ—å­˜å‚¨è¡¨-ğŸ“¦" class="headerlink" title="ä½¿ç”¨åˆ—å­˜å‚¨è¡¨ ğŸ“¦"></a>ä½¿ç”¨åˆ—å­˜å‚¨è¡¨ ğŸ“¦</h3><p>Hive é»˜è®¤ä½¿ç”¨è¡Œå¼å­˜å‚¨ã€‚å‡è®¾æœ‰è¶³å¤Ÿå¤šçš„åˆ—ï¼Œåˆ—ä¸­æœ‰å¾ˆå¤šçš„é‡å¤æ•°æ®ï¼Œè¿™ç§ç±»å‹çš„æ•°æ®ä½¿ç”¨åˆ—å¼å­˜å‚¨æ€§èƒ½ä¼šæ›´å¥½ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ä¸è¦åŠ è½½æ‰€æœ‰åˆ—çš„æ•°æ®ã€‚</p>
<p><em>å‚è§ 15.3.2 RCfile ä½¿ç”¨è¿™ç§æ ¼å¼ï¼Ÿ</em></p>
<h3 id="ä½¿ç”¨å‹ç¼©-ğŸ—œï¸"><a href="#ä½¿ç”¨å‹ç¼©-ğŸ—œï¸" class="headerlink" title="ä½¿ç”¨å‹ç¼© ğŸ—œï¸"></a>ä½¿ç”¨å‹ç¼© ğŸ—œï¸</h3><p>å‡ ä¹æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å‹ç¼©éƒ½èƒ½é™ä½ç£ç›˜å ç”¨é‡ï¼Œé™ä½ I&#x2F;O ä»¥æé«˜æŸ¥è¯¢é€Ÿåº¦ã€‚</p>
<p>ä½¿ç”¨å¤–éƒ¨æ•°æ®æˆ–è€…éå‹ç¼©æ ¼å¼æ—¶æ— æ³•ä½¿ç”¨å‹ç¼©ã€‚</p>
<p>å‹ç¼©å’Œè§£å‹ç¼©éƒ½ä¼šæ¶ˆè€— CPU èµ„æºï¼Œä½†æ˜¯å¤§å¤šæ•° MR ä»»åŠ¡éƒ½æ˜¯ I&#x2F;O å¯†é›†å‹ä»»åŠ¡ï¼Œæ‰€ä»¥ CPU å¼€é”€é€šå¸¸ä¸æ˜¯é—®é¢˜ã€‚</p>
<h2 id="Hive-å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè®°å½•-ğŸ“"><a href="#Hive-å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè®°å½•-ğŸ“" class="headerlink" title="Hive å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè®°å½• ğŸ“"></a>Hive å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè®°å½• ğŸ“</h2><p>1ã€å¯åŠ¨ Hive æŠ¥é”™ï¼šCannot create directory &#x2F;tmp&#x2F;hive&#x2F;longkun&#x2F;50be98c2-62e0-4b37-9002-c2270fed6a20. Name node is in safe mode.</p>
<blockquote>
<p>æ§åˆ¶å°æ—¥å¿—æç¤ºæ— æ³•åˆ›å»ºä¸´æ—¶ç›®å½•ï¼ŒHive å¤„äºå®‰å…¨æ¨¡å¼ä¸­ã€‚</p>
<p>å®‰å…¨æ¨¡å¼ä¸»è¦æ˜¯ HDFS ç³»ç»Ÿçš„æ—¶å€™æ£€æŸ¥ DataNode ä¸Šæ•°æ®å—çš„æœ‰æ•ˆæ€§ï¼ŒåŒæ—¶æ ¹æ®ç­–ç•¥å¤åˆ¶å’Œåˆ é™¤éƒ¨åˆ†æ•°æ®å—ï¼Œè¿è¡Œçš„æ—¶å€™ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¿›å…¥å®‰å…¨æ¨¡å¼ã€‚å®‰å…¨æ¨¡å¼ä¸­ä¸å…è®¸ä¿®æ”¹å’Œåˆ é™¤æ•°æ®ã€‚</p>
<p>å¯ä»¥é€šè¿‡å‘½ä»¤æ¥ç¦»å¼€å®‰å…¨ğŸ”æ¨¡å¼ï¼š<code>hadoop dfsadmin -safemode leave</code> </p>
<p>ç¦»å¼€å®‰å…¨æ¨¡å¼ä¹‹åï¼ŒHive æ­£å¸¸å¯åŠ¨ã€‚</p>
</blockquote>

  </div>
</article>



    <div class="blog-post-comments">
        <div id="giscus_thread">
            <noscript>åŠ è½½è¯„è®ºéœ€è¦åœ¨æµè§ˆå™¨å¯ç”¨ JavaScript è„šæœ¬æ”¯æŒã€‚</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          
            <a href="/">é¦–é¡µ</a>
          
        
          
            <a href="/archives/">å½’æ¡£</a>
          
        
          
            <a href="/friends/">å‹é“¾</a>
          
        
          
            <a target="_blank" rel="noopener" href="https://domain-forsale.happy365.day">åŸŸåå‡ºå”®</a>
          
        
          
            <a href="/about/">å…³äº</a>
          
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">åŸºç¡€çŸ¥è¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-Hive"><span class="toc-number">1.1.</span> <span class="toc-text">ä¸ºä»€ä¹ˆéœ€è¦ Hive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E7%9A%84%E5%B1%80%E9%99%90"><span class="toc-number">1.2.</span> <span class="toc-text">Hive çš„å±€é™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-%E5%92%8C-Hive-%EF%BC%9A%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1%E7%AE%97%E6%B3%95"><span class="toc-number">1.3.</span> <span class="toc-text">Java å’Œ Hive ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.</span> <span class="toc-text">Hive å‘½ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CLI-%E9%80%89%E9%A1%B9"><span class="toc-number">2.1.</span> <span class="toc-text">CLI é€‰é¡¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E7%9A%84%E5%B1%9E%E6%80%A7%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-number">2.2.</span> <span class="toc-text">Hive çš„å±æ€§å‘½åç©ºé—´</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E4%B8%AD%E4%BD%BF%E7%94%A8%E4%B8%80%E6%AC%A1%E5%91%BD%E4%BB%A4"><span class="toc-number">2.3.</span> <span class="toc-text">Hive ä¸­ä½¿ç”¨ä¸€æ¬¡å‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E6%96%87%E4%BB%B6%E4%B8%AD%E6%89%A7%E8%A1%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.4.</span> <span class="toc-text">ä»æ–‡ä»¶ä¸­æ‰§è¡ŒæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hiverc%E6%96%87%E4%BB%B6"><span class="toc-number">2.5.</span> <span class="toc-text">hivercæ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C-shell-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.6.</span> <span class="toc-text">æ‰§è¡Œ shell å‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8-Hive-%E5%86%85%E4%BD%BF%E7%94%A8-dfs-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.7.</span> <span class="toc-text">åœ¨ Hive å†…ä½¿ç”¨ dfs å‘½ä»¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">æ•°æ®ç±»å‹å’Œæ–‡ä»¶æ ¼å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#byte%E3%80%81Byte%E3%80%81bit%E3%80%81%E5%AD%97%E8%8A%82"><span class="toc-number">3.1.</span> <span class="toc-text">byteã€Byteã€bitã€å­—èŠ‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.2.</span> <span class="toc-text">Hive ä¸­çš„æ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.</span> <span class="toc-text">é›†åˆç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89"><span class="toc-number">4.</span> <span class="toc-text">HiveQL æ•°æ®å®šä¹‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%A7%88"><span class="toc-number">4.1.</span> <span class="toc-text">æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.2.</span> <span class="toc-text">å¸¸è§æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E9%83%A8%E8%A1%A8%E4%B8%8E%E5%A4%96%E9%83%A8%E8%A1%A8%EF%BC%88MANAGED-TABLE-EXTERNAL-TABLE%EF%BC%89"><span class="toc-number">4.3.</span> <span class="toc-text">å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨ï¼ˆMANAGED_TABLE &amp; EXTERNAL_TABLEï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8%E5%92%8C%E7%AE%A1%E7%90%86%E8%A1%A8"><span class="toc-number">5.</span> <span class="toc-text">åˆ†åŒºè¡¨å’Œç®¡ç†è¡¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%A1%A8%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">å¯¹è¡¨çš„æ“ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">7.</span> <span class="toc-text">HiveQL æ•°æ®æ“ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.</span> <span class="toc-text">HiveQL æŸ¥è¯¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%EF%BC%9A"><span class="toc-number">8.1.</span> <span class="toc-text">å¸¸ç”¨å‡½æ•°ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97-SELECT"><span class="toc-number">8.2.</span> <span class="toc-text">åµŒå¥— SELECT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CASE-WHEN"><span class="toc-number">8.3.</span> <span class="toc-text">CASE WHEN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%BF%E5%85%8D%E8%BF%9B%E8%A1%8C-MapReduce"><span class="toc-number">8.4.</span> <span class="toc-text">é¿å…è¿›è¡Œ MapReduce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2-cast"><span class="toc-number">8.5.</span> <span class="toc-text">ç±»å‹è½¬æ¢ cast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E6%A0%B7%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.6.</span> <span class="toc-text">æŠ½æ ·æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UNION-ALL"><span class="toc-number">8.7.</span> <span class="toc-text">UNION ALL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E8%A7%86%E5%9B%BE"><span class="toc-number">9.</span> <span class="toc-text">HiveQL è§†å›¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HiveQL-%E7%B4%A2%E5%BC%95"><span class="toc-number">10.</span> <span class="toc-text">HiveQL ç´¢å¼•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1"><span class="toc-number">11.</span> <span class="toc-text">æ¨¡å¼è®¾è®¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="toc-number">11.1.</span> <span class="toc-text">åˆ†åŒºè¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%AF%E4%B8%80%E9%94%AE%E5%92%8C%E6%A0%87%E5%87%86%E5%8C%96"><span class="toc-number">11.2.</span> <span class="toc-text">å”¯ä¸€é”®å’Œæ ‡å‡†åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E4%B8%80%E4%BB%BD%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%A4%9A%E6%AC%A1"><span class="toc-number">11.3.</span> <span class="toc-text">åŒä¸€ä»½æ•°æ®å¤„ç†å¤šæ¬¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E%E6%AF%8F%E4%B8%AA%E8%A1%A8%E7%9A%84%E5%88%86%E5%8C%BA"><span class="toc-number">11.4.</span> <span class="toc-text">å¯¹äºæ¯ä¸ªè¡¨çš„åˆ†åŒº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%A1%B6-%F0%9F%AA%A3"><span class="toc-number">11.5.</span> <span class="toc-text">åˆ†æ¡¶ ğŸª£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E8%A1%A8%E6%96%B0%E5%A2%9E%E5%88%97"><span class="toc-number">11.6.</span> <span class="toc-text">ä¸ºè¡¨æ–°å¢åˆ—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%88%97%E5%AD%98%E5%82%A8%E8%A1%A8-%F0%9F%93%A6"><span class="toc-number">11.7.</span> <span class="toc-text">ä½¿ç”¨åˆ—å­˜å‚¨è¡¨ ğŸ“¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8E%8B%E7%BC%A9-%F0%9F%97%9C%EF%B8%8F"><span class="toc-number">11.8.</span> <span class="toc-text">ä½¿ç”¨å‹ç¼© ğŸ—œï¸</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E8%AE%B0%E5%BD%95-%F0%9F%93%9D"><span class="toc-number">12.</span> <span class="toc-text">Hive å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆè®°å½• ğŸ“</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zhu.happy365.day/20220320/learn-about-hive/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li> -->
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zhu.happy365.day/20220320/learn-about-hive/&text=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zhu.happy365.day/20220320/learn-about-hive/&is_video=false&description=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li> -->
  <li><a class="icon" href="mailto:?subject=Hiveå­¦ä¹ ç¬”è®°&body=Check out this article: https://zhu.happy365.day/20220320/learn-about-hive/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zhu.happy365.day/20220320/learn-about-hive/&title=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zhu.happy365.day/20220320/learn-about-hive/&name=Hiveå­¦ä¹ ç¬”è®°&description=&lt;h2 id=&#34;åŸºç¡€çŸ¥è¯†&#34;&gt;&lt;a href=&#34;#åŸºç¡€çŸ¥è¯†&#34; class=&#34;headerlink&#34; title=&#34;åŸºç¡€çŸ¥è¯†&#34;&gt;&lt;/a&gt;åŸºç¡€çŸ¥è¯†&lt;/h2&gt;&lt;h3 id=&#34;ä¸ºä»€ä¹ˆéœ€è¦-Hive&#34;&gt;&lt;a href=&#34;#ä¸ºä»€ä¹ˆéœ€è¦-Hive&#34; class=&#34;headerlink&#34; title=&#34;ä¸ºä»€ä¹ˆéœ€è¦ Hive&#34;&gt;&lt;/a&gt;ä¸ºä»€ä¹ˆéœ€è¦ Hive&lt;/h3&gt;&lt;p&gt;Hadoop ç”Ÿæ€ç³»ç»Ÿçš„å‡ºç°ï¼Œä¸ºä»¥åˆç†çš„æˆæœ¬å¤„ç†å¤§æ•°æ®é›†æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå®ƒåŸºäº HDFSï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰å®ç°äº†ä¸€ä¸ª MapReduce ç¼–ç¨‹æ¨¡å‹ï¼Œå°†è®¡ç®—ä»»åŠ¡åˆ†æ•£åˆ°å¤šä¸ªç¡¬ä»¶æœºå™¨ä¸Šï¼Œä»è€Œé™ä½æˆæœ¬å¹¶æä¾›æ°´å¹³ä¼¸ç¼©æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä»ç°æœ‰çš„æ•°æ®åŸºç¡€æ¶æ„è½¬ç§»åˆ° Hadoop ä»¥åŠä» Hadoop ä¸­è·å–æ•°æ®æ˜¯ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼ˆMapReduce Java APIï¼‰ï¼ŒHive çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŸºäº Hive å¯ä»¥æ–¹ä¾¿çš„å®ç°ç»“æ„åŒ–æ•°æ®åˆ° Hadoop æ•°æ®ä»“åº“çš„æ•°æ®è½¬ç§»ã€‚&lt;/p&gt;
&lt;p&gt;Hive å°†å¤§å¤šæ•°çš„æŸ¥è¯¢è½¬åŒ–æˆ MR ä»»åŠ¡ï¼ŒHiveQL æ—¢é™ä½äº†ä½¿ç”¨éš¾åº¦ï¼Œä¹Ÿæé«˜äº† Hadoop çš„æ‰©å±•æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;Hive-çš„å±€é™&#34;&gt;&lt;a href=&#34;#Hive-çš„å±€é™&#34; class=&#34;headerlink&#34; title=&#34;Hive çš„å±€é™&#34;&gt;&lt;/a&gt;Hive çš„å±€é™&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Hive é€‚ç”¨äºæ•°æ®ä¸ç»å¸¸å˜åŠ¨ï¼Œè€Œä¸”ä¸éœ€è¦ç«‹å³å¾—åˆ°æŸ¥è¯¢ç»“æœçš„æƒ…å†µã€‚&lt;/li&gt;
&lt;li&gt;ç”±äº Hadoop å’Œ HDFS çš„è®¾è®¡ï¼ŒHive ä¸æ”¯æŒè¡Œçº§åˆ«çš„æ’å…¥ã€åˆ é™¤åŠæ›´æ–°ï¼Œä¸æ”¯æŒäº‹åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;HiveQL ä¸ç¬¦åˆ ANSI SQL æ ‡å‡†ï¼Œå¾ˆå¤š SQL å’Œ Oracleã€MySQL å­˜åœ¨å·®å¼‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;Java-å’Œ-Hive-ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•&#34;&gt;&lt;a href=&#34;#Java-å’Œ-Hive-ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•&#34; class=&#34;headerlink&#34; title=&#34;Java å’Œ Hive ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•&#34;&gt;&lt;/a&gt;Java å’Œ Hive ï¼šè¯é¢‘ç»Ÿè®¡ç®—æ³•&lt;/h3&gt;&lt;p&gt;è¿™æ˜¯ã€ŠHadoopæƒå¨æŒ‡å—ã€‹ä¸­çš„ç¬¬ä¸€ç« çš„ä¾‹å­ç¨‹åºï¼Œä½¿ç”¨ Hadoop Java API å®ç°ä¸€ä¸ªç»Ÿè®¡æ–‡æœ¬æ–‡ä»¶ä¸­æ¯ä¸ªå•è¯å‡ºç°æ¬¡æ•°çš„ç¨‹åºï¼Œå¯ä»¥å¸®åŠ©ç†è§£ MR åŸç†ä»¥åŠä½¿ç”¨ Hive çš„å¥½å¤„ã€‚&lt;/p&gt;
&lt;p&gt;å…³é”®ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zhu.happy365.day/20220320/learn-about-hive/&t=Hiveå­¦ä¹ ç¬”è®°"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li> -->
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    <!-- Copyright --> &copy;
    
    
    2018-2025
    ç§‹è‘µç¬”è®°
  </div>
  <div class="footer-center">
    
      <a href="https://icp.gov.moe/?keyword=20249900" target="_blank">èŒICPå¤‡20249900å·</a>
    
    
      
        <span> | </span>
      
      <a href="https://www.travellings.cn/go.html" target="_blank">ğŸš‡å¼€å¾€</a>
    
    
      
        <span> | </span>
      
      <a href="https://www.foreverblog.cn" target="_blank">åå¹´ä¹‹çº¦</a>
    
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
          
            <a href="/">é¦–é¡µ</a>
          
        
          
            <a href="/archives/">å½’æ¡£</a>
          
        
          
            <a href="/friends/">å‹é“¾</a>
          
        
          
            <a target="_blank" rel="noopener" href="https://domain-forsale.happy365.day">åŸŸåå‡ºå”®</a>
          
        
          
            <a href="/about/">å…³äº</a>
          
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->


 
  <link
    rel="preload"
    href="/lib/font-awesome/css/all.min.css"
    as="style"
    onload="this.onload=null;this.rel='stylesheet'"
  />
  <noscript
    ><link
      rel="stylesheet"
      href="/lib/font-awesome/css/all.min.css"
  /></noscript>


<link rel="stylesheet" href="/css/theme-dark.css">
<!-- <link rel="stylesheet" href="/css/theme-light.css"> -->
<!-- <link rel="stylesheet" href="/css/theme-classic.css"> -->
<link rel="stylesheet" href="/css/theme-white.css">

    <!-- jquery -->

  
<script src="/lib/jquery/jquery.min.js"></script>





<!-- clipboard -->

  
    
<script src="/lib/clipboard/clipboard.min.js"></script>

  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿ï¼\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸï¼");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- 51la Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

<!-- giscus -->

  <script type="text/javascript">
    var giscus_repo = 'qiukuip/my-blog-comments';
    var giscus_repo_id = 'R_kgDOLq3geg';
    var giscus_category = 'Announcements';
    var giscus_category_id = 'DIC_kwDOLq3ges4Cx0qi';
    var giscus_mapping = 'pathname';
    var giscus_strict = '0';
    var giscus_reactions_enabled = '1';
    var giscus_emit_metadata = '';
    var giscus_input_position = 'top';
    var giscus_theme = '';
    var theme_lang = '';
    var giscus_loading = 'lazy';
    var giscus_crossorigin = 'anonymous';

    (function(){
        var script = document.createElement('script');

        script.src = 'https://giscus.app/client.js';
        script.setAttribute('data-repo', giscus_repo);
        script.setAttribute('data-repo-id', giscus_repo_id);
        script.setAttribute('data-category', giscus_category);
        script.setAttribute('data-category-id', giscus_category_id);
        script.setAttribute('data-mapping', giscus_mapping);
        script.setAttribute('data-strict', giscus_strict);
        script.setAttribute('data-reactions-enabled', giscus_reactions_enabled);
        script.setAttribute('data-emit-metadata', giscus_emit_metadata);
        script.setAttribute('data-input-position', giscus_input_position);
        script.setAttribute('data-theme', giscus_theme);
        script.setAttribute('data-lang', theme_lang);
        script.setAttribute('data-loading', giscus_loading);
        script.setAttribute('crossorigin', giscus_crossorigin);
        script.async = true;
        (document.getElementById('giscus_thread')).appendChild(script);
    }());
  </script>


<!-- image modal -->
<script>
  (function() {
    var contentNode = document.getElementsByClassName('content e-content');
    if (!contentNode || contentNode.length === 0) {
      console.log('no content, exit');
      return;
    }

    var imgsNodes = contentNode[0].getElementsByTagName('img');
    if (!imgsNodes || imgsNodes.length === 0) {
      console.log('no image, exit');
      return;
    }

    var span = document.getElementById('modal_close_btn');
    span.onclick = function() { 
      modal.style.display = "none";
    };

    var modal = document.getElementById('modal');
    var modalImage = document.getElementById('modal_image');
    var captionText = document.getElementById('caption');

    for (var i = imgsNodes.length - 1; i >= 0; i--) {
      let image = imgsNodes[i];
      image.onclick = function() {
        modal.style.display = "block";
        modalImage.src = this.src;
        captionText.innerHTML = this.alt || "æ–‡ç« é…å›¾";
      };
    }
  }());
</script>

</body>
</html>
